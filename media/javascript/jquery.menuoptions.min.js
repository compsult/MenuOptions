$.widget("mre.menuoptions",{options:{ClearBtn:true,SelectOnly:false,Data:"",ColumnCount:1,UseValueForKey:false,Width:"",Height:"",ShowAt:"bottom",Sort:["alpha","asc"],Filters:[],MenuOptionsType:"Select",DisableHiLiting:false,ShowDownArrow:true,InitialValue:{},RockerControl:false,_ID:"UnIqDrOpDoWnSeLeCt",_vert_ofs:0,_prev_event:"",_prev_target:"",_prevXY:{X:0,Y:0},_CurrentFilter:"",_orig_bg:"",_currTD:[0,1],_event_ns:"",_curr_img:"",_menu_box:{top:0,bottom:0,left:0,right:0,},_width_adj:{width_menu:0,width_adjustment:0,width_after_adj:0},},_create:function(){var a="";if(this.options.Data.toString()===""){this._validation_fail("MenuOptions requires the Data parameter to be populated");return}if(this.options.ColumnCount<1){this._validation_fail("MenuOptions requires ColumnCount parameter be > 0");return}this.orig_objs=this.ary_of_objs=this._build_array_of_objs();if(this.orig_objs===false){this._validation_fail("Invalid Data format supplied to menuoptions");return}this._set_options();if(this.options.RockerControl==true){if(this._rocker_main({val:""})==false){return}}else{this._add_clear_btn();this._build_dropdown(this.orig_objs);this._bind_events();$(this.element).attr("autocomplete","off")}this._detect_destroyed_input();this._refresh();$(this.element).addClass("ui-menuoptions")},_validation_fail:function(a){alert(a);this._destroy()},set_select_value:function(a){this.ary_of_objs=this.orig_objs;if("ky" in a){var b=$.grep(this.ary_of_objs,function(c){return parseInt(c.ky)===parseInt(a.ky)});val=b[0].val}else{val=a.val}if(this.options.RockerControl==true){this._change_rocker($(this.element).parent().find("span:contains("+val+")").parent())}else{this.element.val(val);this.add_menuoption_key()}},_change_rocker:function(a){$(this.element).attr("menu_opt_key",a.attr("menu_opt_key"));$(this.element).val(a.find("span").text());if(/ltup/.test(a.attr("class"))){$("div#RK_LT_"+this._event_ns).attr("class","ltdown");$("div#RK_RT_"+this._event_ns).attr("class","rtup")}else{if(/rtup/.test(a.attr("class"))){$("div#RK_LT_"+this._event_ns).attr("class","ltup");$("div#RK_RT_"+this._event_ns).attr("class","rtdown")}}},_rocker_main:function(a){if(this.orig_objs.length!=2){this._validation_fail("When using the rocker control, exactly 2 elements need to be supplied to menuoptions");return false}if($("div.rocker[id=RK_"+this._event_ns+"]").length){$("div.rocker[id=RK_"+this._event_ns+"]").remove()}this._create_rocker();this._bind_rocker();if(a.val.length>0){this.set_select_value(a)}},_bind_rocker:function(){this._on($("div[id$=T_"+this._event_ns+"]"),{click:"_rocker_click"})},_initval_exists:function(){var a=false;if(("val" in this.options.InitialValue&&this.options.InitialValue.val.length>0)||("ky" in this.options.InitialValue&&this.options.InitialValue.ky.length>0)){a=true}return a},_create_rocker:function(c){var b="rtup",a="ltup",d=$(this.element).val();$(this.element).hide();$(this.element).next("div.clear_btn").hide();this._event_ns=this.eventNamespace.replace(/^\./,"");if(this._initval_exists()){this.set_select_value(this.options.InitialValue)}if(d.length>0&&new RegExp(d).test(this.orig_objs[0].val)){a="ltdown"}if(d.length>0&&new RegExp(d).test(this.orig_objs[1].val)){b="rtdown"}$(this.element).parent().append("<div class=rocker id=RK_"+this._event_ns+"><div id=RK_LT_"+this._event_ns+" class="+a+" menu_opt_key="+this.orig_objs[0].ky+"></div><div id=RK_RT_"+this._event_ns+" class="+b+" menu_opt_key="+this.orig_objs[1].ky+"></div></div></div>");$("div#RK_LT_"+this._event_ns).append('<span class=innertext style="padding-left:10px">'+this.orig_objs[0].val+"</span>");$("div#RK_RT_"+this._event_ns).append('<span class=innertext style="padding-right:10px">'+this.orig_objs[1].val+"</span>")},_rocker_click:function(a){var b=$(a.target).is("[menu_opt_key]")?$(a.target):$(a.target.parentElement);this._change_rocker(b);this._trigger("onSelect",this,{newCode:b.attr("menu_opt_key"),newVal:b.children().text(),type:"RockerClick"})},refreshData:function(b){var c=this,a=$(this.element).val();$(this.element).attr("menu_opt_key","");$(this.element).val("");$.each(b,function(d,e){if(c.options.hasOwnProperty(d)){if(c.options.RockerControl==true){if(/RockerControl|Data/i.test(d)){c._setOption(d,b[d])}}else{c._setOption(d,b[d])}}});this._set_options();this.orig_objs=this.ary_of_objs=this._build_array_of_objs();if(this.options.RockerControl==true){this._rocker_main({val:a})}else{if($("div.rocker[id=RK_"+this._event_ns+"]").length){$("div.rocker[id=RK_"+this._event_ns+"]").remove();$(this.element).show();$(this.element).next("div.clear_btn").show()}this._build_dropdown(this.orig_objs)}},add_menuoption_key:function(){var a=this.element.val();var b=$.grep(this.ary_of_objs,function(c){return c.val===a});if(b.length>0){$(this.element).attr("menu_opt_key",b[0].ky)}else{alert(a+" was not found in select list")}},_detect_destroyed_input:function(){$(this.element).bind("remove",function(a){this._destroy()})},_buildWholeDropDown:function(a){if(a.type==="search"){$(this.element).attr("menu_opt_key","")}if(/Select/.test($(this.options)[0].MenuOptionsType)&&a.type==="mouseenter"&&this.options._prev_event==="mouseenter"&&!/(all)/.test($(a.target).text())){return}if(/Navigate/.test($(this.options)[0].MenuOptionsType)&&(/mouseenter/.test(a.type))){$(this.options)[0]._curr_img=$(a.currentTarget)}if($("table.CrEaTeDtAbLeStYlE").is(":visible")&&this.cached[".mo_elem"].val().length===0&&$(this.options)[0]._CurrentFilter.length===0&&/Navigate/.test($(this.options)[0].MenuOptionsType)){return}if((a.type==="click"&&this.options._prev_event==="mouseenter")||(a.type==="mousedown"&&this.options._prev_event==="mouseenter")){return}this.options._currTD=[0,1];this.options._prev_event=a.type;this.ary_of_objs=this.orig_objs;if(this.cached[".mo_elem"].val().length){this._process_matches(a,this.cached[".mo_elem"].val(),true);return}this._build_dropdown(this.orig_objs);this._show_drop_down(a)},_build_filtered_dropdown:function(a){this._build_dropdown(this.ary_of_objs);this._show_drop_down(a)},_build_dropdown:function(a){this._event_ns=this.eventNamespace.replace(/^\./,"");tablehtml=this._create_table(a);this.dropdownbox=$(tablehtml);this._cache_elems();this._calcDropBoxCoordinates()},_color_border:function(b,a){var d="";if(this.options.DisableHiLiting){return}var c=false;if(a){c=$.grep(this.ary_of_objs,function(e){d=e.val.replace(/<.*?>/g,"");return b.match(new RegExp(d,"i"))});if(c.length===0){$(this.element).css({"border-color":"red"})}else{$(this.element).css({"border-color":this.options._orig_bg})}}},__triggerChoice:function(b){var a=$("table.CrEaTeDtAbLeStYlE").find("td:first");var c=$(".CrEaTeDtAbLeStYlE tr td.mo");if(c.length>0){a=c}this.element.val(a.text());this.element.attr("menu_opt_key",a.attr("menu_opt_key"));$(this.element).css({"border-color":this.options._orig_bg});this._trigger("onSelect",this,{newCode:$(b.target).attr("menu_opt_key"),newVal:a.text(),type:"EnterKey"});this.cached[".dropdownspan"].remove()},__buildMatchAry:function(f,e,a){var a="";origImg="",newval="",$dd=this;var d=e.charAt(e.length-1);if(e.match(/\{|\}|\\|\*|\(|\)|\./)&&!($(this.options)[0].MenuOptionsType.match(/Navigate/i))){var c=[e.slice(0,(e.length-1)),"\\",d].join("");e=c}var b=new RegExp(e,"i");var g=$.map(this.orig_objs,function(h){if(/Navigate/i.test($($dd.options)[0].MenuOptionsType)&&b.test(h.val)){return h}else{a=h.val.replace(/<img.*>/,"");if(b.test(a)){newval=a.replace(b,'<span style="color:brown;font-size:110%;">'+a.match(b)+"</span>");origImg=h.val.match(/<img.*>/);if(origImg){newval=origImg+newval}return{ky:h.ky,val:newval}}}});if(g.length===0){this.cached[".mo_elem"].val(this.cached[".mo_elem"].val().slice(0,-1))}return g},_process_matches:function(d,c,a){var e=[],b="";if(c!==""){e=this.__buildMatchAry(d,c,false);this.cached[".dropdownspan"].remove()}if(e.length>0){this.ary_of_objs=e;this._build_filtered_dropdown(d)}else{this._buildWholeDropDown(d)}this._color_border(c,a)},_run_header_filter:function(b){if(this.cached[".mo_elem"].val().length){return}if(this.options._CurrentFilter===$(b.currentTarget).text()){return}var a=$(b.currentTarget).text();this.options._CurrentFilter=$(b.currentTarget).text();if($.isPlainObject(this.options.Filters[0])){if($(b.currentTarget).attr("menuopt_regex")){a=$(b.currentTarget).attr("menuopt_regex");this._process_matches(b,a,false)}else{if($(b.currentTarget).text().match(/\(all\)/i)){this._buildWholeDropDown(b)}else{alert("Filter key "+$(b.currentTarget).text()+"does not have a matching regular expression")}}}else{if($.inArray(a,this.options.Filters)>-1){this._process_matches(b,a,false)}else{this._buildWholeDropDown(b)}}},_createFilterHeader:function(){var b=[],a="";if(!$.isPlainObject(this.options.Filters[0])){b=$.map(this.options.Filters,function(d,c){return"\t<td class=dflt>"+d+"</td>\n"});b.unshift("\t<td class=dflt>(all)</td>\n")}else{$.each(this.options.Filters,function(c,d){for(var e in d){a=e}b.push('\t<td class=dflt menuopt_regex="'+d[e]+'">'+a+"</td>\n")});b.unshift("\t<td class=dflt>(all)</td>\n")}return"\n<table id=HF_"+this._event_ns+" class=HdrFilter>\n<tr>\n"+b.join("")+"</tr>\n</table>\n"},_clear_filter:function(a){this.options._CurrentFilter=""},_bind_events:function(){var c="",b={},a=this;c="mouseenter span#SP_"+this.options._ID+" table#HF_"+this._event_ns+" td.dflt";b[c]="_run_header_filter";c="click span#SP_"+this.options._ID+" table#HF_"+this._event_ns+" td.dflt";b[c]="_run_header_filter";c="mouseleave  span#SP_"+this.options._ID+" table#HF_"+this._event_ns+" td.dflt";b[c]="_clear_filter";this._on($("body"),b);this._on(this.cached[".clearBtn"],{mouseleave:"_hiLiteOnOff",mouseenter:"_hiLiteOnOff",click:function(d){$(this.element).val("");$(this.element).attr("menu_opt_key","");this._buildWholeDropDown(d)}});this._on({mousedown:"_buildWholeDropDown",click:"_buildWholeDropDown",mouseenter:"_buildWholeDropDown",focus:"_buildWholeDropDown",input:"_buildWholeDropDown",search:"_buildWholeDropDown",mouseleave:"_removeDropDown",blur:"_removeDropDown",});this._on($("body"),{"mouseleave span table.CrEaTeDtAbLeStYlE td.dflt":"_hiLiteOnOff","mouseenter span table.CrEaTeDtAbLeStYlE td.dflt":"_hiLiteOnOff"});c="mousedown span#SP_"+this.options._ID+" table.CrEaTeDtAbLeStYlE td ";b[c]="_choice_selected";this._on($("body"),b);c="mouseleave span#SP_"+this.options._ID;b[c]="_removeDropDown";this._on($("body"),b);this._on(this.cached[".mo_elem"],{keypress:"_autocomplete",keydown:"_autocomplete",keyup:"_autocomplete",})},_arrow_keys:function(a){var g=a.keyCode;var b=39,e=37,f=38,c=40;if(/keydown|keyup/.test(a.type)){if(/keydown/.test(a.type)&&(g===b||g===e||g===f||g===c)){a.preventDefault();return true}var h=false,k=this.options._currTD[0],d=this.options._currTD[1],j=$(".CrEaTeDtAbLeStYlE tr td.mo");switch(a.keyCode){case $.ui.keyCode.TAB:return false;break;case $.ui.keyCode.RIGHT:if(d<$(".CrEaTeDtAbLeStYlE tbody tr:nth-child(1) td").length){d=this.options._currTD[1]=this.options._currTD[1]+1}h=true;break;case $.ui.keyCode.LEFT:if(d>1){d=this.options._currTD[1]=this.options._currTD[1]-1}h=true;break;case $.ui.keyCode.UP:if(k>1){k=this.options._currTD[0]=this.options._currTD[0]-1}this.__scroll(k);h=true;break;case $.ui.keyCode.DOWN:if(k<$(".CrEaTeDtAbLeStYlE tbody tr").length){k=this.options._currTD[0]+=1}this.__scroll(k);h=true;break;case $.ui.keyCode.ENTER:if(/divider/.test($(j).prop("class"))){h=false}else{if(j.length>0){if(/Select/.test($(this.options)[0].MenuOptionsType)){this.__triggerChoice(a)}else{if(/keydown/.test(a.type)){this._run_menu_item(a)}}}}a.preventDefault();break;case $.ui.keyCode.DELETE:if($(this.options)[0].MenuOptionsType.match(/Select/i)&&this.cached[".mo_elem"].length===0){this.cached[".dropdownspan"].remove();$(".CrEaTeDtAbLeStYlE tr td").removeClass("mo");this._buildWholeDropDown(a)}break}if(h==true){$(".CrEaTeDtAbLeStYlE tr td").removeClass("mo");$(".CrEaTeDtAbLeStYlE tr:nth-child("+k+") td:nth-child("+d+")").addClass("mo");return h}}return false},__scroll:function(e){var b=$(".CrEaTeDtAbLeStYlE tbody tr:nth-child("+e+")").offset().top,d=$(".CrEaTeDtAbLeStYlE tbody tr:nth-child("+e+")").height(),a=$("span#SP_"+this.options._ID).height(),c=$("span#SP_"+this.options._ID).offset().top;if(c>b){this.options._vert_ofs-=d;$("span#SP_"+this.options._ID).scrollTop(this.options._vert_ofs)}else{if(c+a<b+d){this.options._vert_ofs+=d;$("span#SP_"+this.options._ID).scrollTop(this.options._vert_ofs)}}},_autocomplete:function(a){if(/keydown|keyup/.test(a.type)&&this._arrow_keys(a)===true){return}if(/Navigate/.test($(this.options)[0].MenuOptionsType)){return}if(a.keyCode===$.ui.keyCode.ENTER){a.preventDefault()}if(/keydown/.test(a.type)){if(this.cached[".mo_elem"].is(":visible")&&a.keyCode===$.ui.keyCode.ENTER||(a.keyCode===$.ui.keyCode.TAB&&this.cached[".mo_elem"].val().length>0)){this._process_matches(a,this.cached[".mo_elem"].val(),true);this.__triggerChoice(a);return}}if(/keyup/.test(a.type)||a.keyCode==$.ui.keyCode.BACKSPACE){this._process_matches(a,this.cached[".mo_elem"].val(),true)}},_hiLiteOnOff:function(a){if(!!$(a.target).attr("class")){if($(a.target).attr("class").match(/clear_btn/)){$(a.target).toggleClass("ClearButtonMO")}if($(a.target).attr("class").match(/ *dflt */)){if(a.type==="mouseenter"){$(a.target).addClass("mo")}else{$("span table.CrEaTeDtAbLeStYlE td.dflt").removeClass("mo")}}}},_refresh:function(){},_cache_elems:function(){var d=this.dropdownbox,b=this.dropdownbox.find("td"),c=this.element,a=$("div#CB_"+this._event_ns);this.cached={".dropdownspan":d,".dropdowncells":b,".clearBtn":a,".mo_elem":c}},_setOptions:function(){this._superApply(arguments);this._refresh()},_setOption:function(a,b){this._super(a,b)},_set_options:function(){if(this.options.ShowAt.match(/^ *bottom *$/i)){this._setOption("ShowAt","left bottom-1")}else{if(this.options.ShowAt.match(/^ *right *$/i)){this._setOption("ShowAt","right top")}}if(this._initval_exists()){this.set_select_value(this.options.InitialValue)}if(this.options.SelectOnly){$(this.element).prop("readonly",true)}this._setOption("Data",this.options.Data);this._setOption("_ID",this.eventNamespace.replace(/^\./,""));this._setOption("_orig_bg",$(this.element).css("background-color"))},re_serialize:function(b){var a="";$.each(b.split("&"),function(d,c){$.each(c.split("="),function(f,e){if($('input[name="'+e+'"]')&&$('input[name="'+e+'"]').attr("menu_opt_key")){a+=e+"="+$('input[name="'+e+'"]').attr("menu_opt_key")+"&"}else{a+=e+"="+$('input[name="'+e+'"]').val()+"&"}return false})});return a.slice(0,-1)},_destroy:function(){$(this.element).removeClass("ui-menuoptions");$("span#SP_"+this.options._ID).remove();this._super()},_runSort:function(a){if(this.options.Sort.length>0){sortInstruct=this.options.Sort;if(sortInstruct[0].match(/alpha/i)&&sortInstruct[1].match(/asc/i)){a.sort(function(d,c){return((d.val)>(c.val)?1:((c.val)>(d.val))?-1:0)})}if(sortInstruct[0].match(/alpha/i)&&sortInstruct[1].match(/desc/i)){a.sort(function(d,c){return((d.val)<(c.val)?1:((c.val)<(d.val))?-1:0)})}if(sortInstruct[0].match(/num/i)&&sortInstruct[1].match(/asc/i)){a.sort(function(d,c){return(d-c)})}if(sortInstruct[0].match(/num/i)&&sortInstruct[1].match(/desc/i)){a.sort(function(d,c){return(c-d)})}}},_create_table:function(a){var b="",d=[],g=0,f=0,c="",e=this;this._runSort(a);if(this.options.UseValueForKey===true&&a.length==this.orig_objs.length){$.each(a,function(j,h){h.val=h.ky})}while(g*this.options.ColumnCount<a.length){f=g===0?0:(g*this.options.ColumnCount);subary=a.slice(f,f+this.options.ColumnCount);d=$.map(subary,function(j,h){if(!$.isFunction(j.ky)&&j.ky.match(/^ *divider *$/i)&&e.options.MenuOptionsType==="Navigate"){return"\t<td class="+j.ky+">"+j.val+"</td>\n"}else{return'\t<td class=dflt menu_opt_key="'+j.ky+'">'+j.val+"</td>\n"}});for(i=subary.length+1;i<=this.options.ColumnCount;i+=1){d.push('<td class=dflt menu_opt_key="">&nbsp;</td>')}b+="<tr>\n"+d.join("")+"</tr>\n";g+=1}b="<table class=CrEaTeDtAbLeStYlE cellpadding=4px>\n"+b+"</table>";if(this.options.Filters.length&&$(this.element).val().length==0){b=this._createFilterHeader()+b}c="<span id=SP_"+this.options._ID+">"+b+"\n</span>";return c},_add_clear_btn:function(){if(this.options.ClearBtn&&/Select/.test(this.options.MenuOptionsType)){ClrBtn="<div class=clear_btn id=CB_"+this.eventNamespace.replace(/^\./,"")+"></div>";$(this.element).after(ClrBtn)}if(/Navigate/.test(this.options.MenuOptionsType)&&this.options.ShowDownArrow){if(/button|img|div/i.test(this.element.prop("tagName"))){this.element.html(this.element.html()+"&nbsp;&#x25BE;")}else{$(this.element).after("&nbsp;&#x25BE;")}}},_obj_create:function(a,b){if($.isArray(b)==true){a.push({ky:b[0],val:b[1]})}else{for(var c in b){if(b.hasOwnProperty(c)){a.push({ky:c,val:b[c]})}else{alert("Data error: Key with no value error in incoming Data parameter");return false}}}return true},_build_array_of_objs:function(){var b=this,a=[];if(typeof b.options.Data[0]==="string"){a=$.map(b.options.Data,function(d,c){return{ky:d,val:d}})}else{$.each(b.options.Data,function(c,d){if(!$.isArray(b.options.Data)){a.push({ky:c,val:d})}else{if($.isPlainObject(b.options.Data[0])){if(b._obj_create(a,d)===false){return false}}else{if($.isArray(b.options.Data[0])){b._obj_create(a,d)}}}b.total_rec_cnt+=1})}if(b.options.MenuOptionsType==="Navigate"){a=$.map(a,function(d,c){return{ky:d.val,val:d.ky}})}return a},_run_menu_item:function(c){var a=$(c.target).text();var b=$(".CrEaTeDtAbLeStYlE tr td.mo");if(b.length>0){a=b.text()}var d=$.grep(this.ary_of_objs,function(e){return a===e.val.replace(/^< *img.*?>/,"")});if(d&&d.length>0){if($.isFunction(d[0].ky)){d[0].ky.call()}else{if(!$(c.target).attr("class").match(/^ *divider *$/i)){window.open(d[0].ky)}}}},_choice_selected:function(c){this.cached[".dropdownspan"].remove();if($(c.currentTarget).text()===this._prev_target&&c.pageX===this.options._prevXY.X&&c.pageY===this.options._prevXY.Y){return}this._prev_target=$(c.currentTarget).text();this.options._prevXY.X=c.pageX;this.options._prevXY.Y=c.pageY;this.options._prev_event=c.type;var b=this;if(b.options.MenuOptionsType==="Select"){var a=$.trim($(c.currentTarget).text());b.element.val(a);b._trigger("onSelect",b,{newCode:$(c.target).attr("menu_opt_key"),newVal:a,type:"Click"});b.element.attr("menu_opt_key",$(c.target).attr("menu_opt_key"));c.target.className=c.target.className.replace(/ mo/,"")}else{this._run_menu_item(c)}$(this.cached[".dropdowncells"]).removeClass("mo");b.cached[".dropdownspan"].remove();$(this.element).css({"border-color":this.options._orig_bg})},_calcDropBoxCoordinates:function(){this.options._menu_box.top=this.cached[".dropdownspan"].position().top;this.options._menu_box.bottom=this.options._menu_box.top+this.cached[".dropdownspan"].height();this.options._menu_box.left=this.cached[".dropdownspan"].position().left;this.options._menu_box.right=this.options._menu_box.left+this.cached[".dropdownspan"].width()},_didMouseExitDropDown:function(a){if(a.pageX+1>this.options._menu_box.left&&a.pageX<this.options._menu_box.right-1&&a.pageY+1>this.options._menu_box.top&&a.pageY<this.options._menu_box.bottom){return false}else{return true}},_removeDropDown:function(a){if(/Navigate/.test($(this.options)[0].MenuOptionsType)&&(/mouseleave/.test(a.type))){$(this.options)[0]._curr_img=null}this.options._prev_event=a.type;if(a.type==="blur"&&this.options._prev_event==="mouseleave"){return}if($("span#SP_"+this.options._ID).length){if(this._didMouseExitDropDown(a)===true){this.cached[".dropdownspan"].remove()}}},_resetOffsetOfDropDown:function(){if($dd_span.menu_start_loc.left!==$dd_span.cached[".dropdownspan"].offset().left||$dd_span.menu_start_loc.top!==$dd_span.cached[".dropdownspan"].offset().top){if($dd_span.cached[".dropdownspan"]&&$dd_span.cached[".dropdownspan"][0]){$dd_span.options._width_adj.width_adjustment=parseInt($dd_span.cached[".dropdownspan"][0].style.left)+(($dd_span.options._width_adj.width_after_adj-$dd_span.options._width_adj.width_menu)/2);$dd_span.cached[".dropdownspan"].css({left:$dd_span.options._width_adj.width_adjustment})}}},_addDropDownToDOM:function(){var a=this;$('body span[id^="SP_menuoption"]').remove();this.dropdownbox.appendTo("body").hide(1)},_show_drop_down:function(b){var c=this,a=0;this._addDropDownToDOM();this._get_n_set_width();c.cached[".dropdownspan"].stop(true,false).show().position({of:this.element,my:"left top",at:c.options.ShowAt,collision:"flipfit"});a=parseInt($("span#SP_"+this.options._ID).css("width"));$("span#SP_"+c.options._ID).css({zIndex:9999});if(this._use_scroller()){$("span#SP_"+c.options._ID).css({"overflow-y":"scroll","overflow-x":"hidden",width:a+18,height:parseInt(c.options.Height)});c.cached[".dropdownspan"].stop(true,false).show().position({of:this.element,my:"left top",at:c.options.ShowAt,collision:"flipfit"})}$("table.CrEaTeDtAbLeStYlE").find("tr:even").addClass("even");$("table.CrEaTeDtAbLeStYlE").find("tr:odd").addClass("odd");this._refresh();this._calcDropBoxCoordinates()},_use_scroller:function(){var a=parseInt($("span#SP_"+this.options._ID).css("height"));return/Select/i.test(this.options.MenuOptionsType)&&/^\d+/.test(this.options.Height)&&parseInt(this.options.Height)<a},_get_n_set_width:function(){var b=this,a=parseInt($("span#SP_"+this.options._ID).css("width"),10),c=parseInt($("span#SP_"+this.options._ID).css("height"));b.menu_start_loc=b.cached[".dropdownspan"].offset();b.options._width_adj.width_menu=a;b.options._width_adj.width_after_adj=(a>$(this.element).width())?a:$(this.element).outerWidth();if(b.options.Width!==""&&b.options.Width!==0){b.options._width_adj.width_after_adj=(parseInt(b.options.Width))}$("span#SP_"+b.options._ID+", span#SP_"+b.options._ID+" > table").css({width:b.options._width_adj.width_after_adj});if(this.options.ShowAt.match(/left.*bottom.*/i)){$("span#SP_"+b.options._ID).offset({left:$(this.element).offset().left})}else{$("span#SP_"+b.options._ID).offset({left:$(this.element).offset().left+$(this.element).outerWidth()})}},});