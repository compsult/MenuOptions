/*! menuoptions 2015-09-10 */
"use strict";$.widget("mre.menuoptions",{options:{ClearBtn:!0,SelectOnly:!1,Data:"",ColumnCount:1,UseValueForKey:!1,Width:"",Height:"",ShowAt:"bottom",Sort:["alpha","asc"],Filters:[],MenuOptionsType:"Select",DisableHiLiting:!1,ShowDownArrow:"black",InitialValue:{},Window:"repl",_ID:"UnIqDrOpDoWnSeLeCt",_vert_ofs:0,_prev_event:"",_prev_target:"",_prevXY:{X:0,Y:0},_CurrentFilter:"",_orig_bg:"",_currTD:[0,1],_event_ns:"",_curr_img:"",_menu_box:{top:0,bottom:0,left:0,right:0},_width_adj:{width_menu:0,width_adjustment:0,width_after_adj:0}},_create:function(){if(""===this.options.Data.toString())return void this._validation_fail("MenuOptions requires the Data parameter to be populated");if(this.options.ColumnCount<1)return void this._validation_fail("MenuOptions requires ColumnCount parameter be > 0");if(this.orig_objs=this.ary_of_objs=this._build_array_of_objs(),this.orig_objs===!1)return void this._validation_fail("Invalid Data format supplied to menuoptions");if(this._set_options(),/Rocker/i.test($(this.options)[0].MenuOptionsType)){if(this._rocker_main({val:""})===!1)return}else this._add_clear_btn(),this._build_dropdown(this.orig_objs),this._bind_events(),$(this.element).attr("autocomplete","off");this._detect_destroyed_input(),this._refresh(),$(this.element).addClass("ui-menuoptions")},_validation_fail:function(a){alert(a),this._destroy()},set_select_value:function(a){var b="",c={};this.ary_of_objs=this.orig_objs,a.hasOwnProperty("ky")?(c=$.grep(this.ary_of_objs,function(b){return parseInt(b.ky,10)===parseInt(a.ky,10)}),b=c[0].val):b=a.val,/Rocker/i.test($(this.options)[0].MenuOptionsType)?this._change_rocker($(this.element).parent().find("span:contains("+b+")").parent()):(this.element.val(b),this.add_menuoption_key())},_change_rocker:function(a){$(this.element).attr("menu_opt_key",a.attr("menu_opt_key")),$(this.element).val(a.find("span").text()),/ltup/.test(a.attr("class"))?($("div#RK_LT_"+this._event_ns).attr("class","ltdown"),$("div#RK_RT_"+this._event_ns).attr("class","rtup")):/rtup/.test(a.attr("class"))&&($("div#RK_LT_"+this._event_ns).attr("class","ltup"),$("div#RK_RT_"+this._event_ns).attr("class","rtdown"))},_rocker_main:function(a){return 2!==this.orig_objs.length?(this._validation_fail("When using the rocker control, exactly 2 elements need to be supplied to menuoptions"),!1):($("div.rocker[id=RK_"+this._event_ns+"]").length&&$("div.rocker[id=RK_"+this._event_ns+"]").remove(),this._create_rocker(),this._bind_rocker(),void(a.val.length>0&&this.set_select_value(a)))},_bind_rocker:function(){this._on($("div[id$=T_"+this._event_ns+"]"),{click:"_rocker_click"})},_initval_exists:function(){var a=!1;return(this.options.InitialValue.hasOwnProperty("val")&&this.options.InitialValue.val.length>0||this.options.InitialValue.hasOwnProperty("ky")&&this.options.InitialValue.ky.length>0)&&(a=!0),a},_create_rocker:function(){var a="rtup",b="ltup",c=$(this.element).val();$(this.element).hide(),$(this.element).next("div.clear_btn").hide(),this._event_ns=this.eventNamespace.replace(/^\./,""),this._initval_exists()&&this.set_select_value(this.options.InitialValue),c.length>0&&new RegExp(c).test(this.orig_objs[0].val)&&(b="ltdown"),c.length>0&&new RegExp(c).test(this.orig_objs[1].val)&&(a="rtdown"),$(this.element).parent().append("<div class=rocker id=RK_"+this._event_ns+"><div id=RK_LT_"+this._event_ns+" class="+b+" menu_opt_key="+this.orig_objs[0].ky+"></div><div id=RK_RT_"+this._event_ns+" class="+a+" menu_opt_key="+this.orig_objs[1].ky+"></div></div></div>"),$("div#RK_LT_"+this._event_ns).append('<span class=innertext style="padding-left:10px">'+this.orig_objs[0].val+"</span>"),$("div#RK_RT_"+this._event_ns).append('<span class=innertext style="padding-right:10px">'+this.orig_objs[1].val+"</span>")},_rocker_click:function(a){var b=$(a.target).is("[menu_opt_key]")?$(a.target):$(a.target.parentElement);this._change_rocker(b),this._trigger("onSelect",this,{newCode:b.attr("menu_opt_key"),newVal:b.children().text(),type:"RockerClick"})},refreshData:function(a){var b=this,c=$(this.element).val();$(this.element).attr("menu_opt_key",""),$(this.element).val(""),$.each(a,function(c){b.options.hasOwnProperty(c)&&b._setOption(c,a[c])}),this._set_options(),this.orig_objs=this.ary_of_objs=this._build_array_of_objs(),/Rocker/i.test($(this.options)[0].MenuOptionsType)?this._rocker_main({val:c}):($("div.rocker[id=RK_"+this._event_ns+"]").length&&($("div.rocker[id=RK_"+this._event_ns+"]").remove(),$(this.element).show(),$(this.element).next("div.clear_btn").show()),this._build_dropdown(this.orig_objs))},add_menuoption_key:function(){var a=this.element.val(),b=$.grep(this.ary_of_objs,function(b){var c=b.val.replace(/<[\w\W]*?>/g,"");return c===a});b.length>0?$(this.element).attr("menu_opt_key",b[0].ky):alert(a+" was not found in select list")},_detect_destroyed_input:function(){$(this.element).bind("remove",function(){this._destroy()})},_buildWholeDropDown:function(a){if("search"===a.type&&$(this.element).attr("menu_opt_key",""),(!/Select/.test($(this.options)[0].MenuOptionsType)||"mouseenter"!==a.type||"mouseenter"!==this.options._prev_event||/(all)/.test($(a.target).text()))&&(/Navigate/.test($(this.options)[0].MenuOptionsType)&&/mouseenter/.test(a.type)&&($(this.options)[0]._curr_img=$(a.currentTarget)),!($("table.CrEaTeDtAbLeStYlE").is(":visible")&&0===this.cached[".mo_elem"].val().length&&0===$(this.options)[0]._CurrentFilter.length&&/Navigate/.test($(this.options)[0].MenuOptionsType)||"click"===a.type&&"mouseenter"===this.options._prev_event||"mousedown"===a.type&&"mouseenter"===this.options._prev_event))){if(this.options._currTD=[0,1],this.options._prev_event=a.type,this.ary_of_objs=this.orig_objs,this.cached[".mo_elem"].val().length)return void this._process_matches(a,this.cached[".mo_elem"].val(),!0);this._build_dropdown(this.orig_objs),this._show_drop_down(a)}},_build_filtered_dropdown:function(a){this._build_dropdown(this.ary_of_objs),this._show_drop_down(a)},_build_dropdown:function(a){var b=this._create_table(a);this._event_ns=this.eventNamespace.replace(/^\./,""),this.dropdownbox=$(b),this._cache_elems(),this._calcDropBoxCoordinates()},_color_border:function(a,b){var c="",d=!1;this.options.DisableHiLiting||b&&(d=$.grep(this.ary_of_objs,function(b){return c=b.val.replace(/<[\w\W]*?>/g,""),a.match(new RegExp(c,"i"))}),0===d.length?$(this.element).css({"border-color":"red"}):$(this.element).css({"border-color":this.options._orig_bg}))},__triggerChoice:function(a){var b=$("table.CrEaTeDtAbLeStYlE").find("td:first"),c=$(".CrEaTeDtAbLeStYlE tr td.mo");c.length>0&&(b=c),this.element.val(b.text()),this.element.attr("menu_opt_key",b.attr("menu_opt_key")),$(this.element).css({"border-color":this.options._orig_bg}),this._trigger("onSelect",this,{newCode:$(a.target).attr("menu_opt_key"),newVal:b.text(),type:"EnterKey"}),this.cached[".dropdownspan"].remove()},__buildMatchAry:function(a,b){var c="",d="",e="",f=this,g=a.charAt(a.length-1),h="",i=[];return a.match(/\{|\}|\\|\*|\(|\)|\./)&&!$(this.options)[0].MenuOptionsType.match(/Navigate/i)&&(e=[a.slice(0,a.length-1),"\\",g].join(""),a=e),h=new RegExp(a,"i"),i=$.map(this.orig_objs,function(a){return/Navigate/i.test($(f.options)[0].MenuOptionsType)&&h.test(a.val)?a:(b=a.val.replace(/<img[\w\W]*?>/,""),h.test(b)?(d=b.replace(h,'<span style="color:brown;font-size:110%;">'+b.match(h)+"</span>"),c=a.val.match(/<img[\w\W]*?>/),c&&(d=c+d),{ky:a.ky,val:d}):void 0)}),0===i.length&&this.cached[".mo_elem"].val(this.cached[".mo_elem"].val().slice(0,-1)),i},_process_matches:function(a,b,c){var d=[];""!==b&&(d=this.__buildMatchAry(b,!1),this.cached[".dropdownspan"].remove()),d.length>0?(this.ary_of_objs=d,this._build_filtered_dropdown(a)):this._buildWholeDropDown(a),this._color_border(b,c)},_run_header_filter:function(a){if(!this.cached[".mo_elem"].val().length&&this.options._CurrentFilter!==$(a.currentTarget).text()){var b=$(a.currentTarget).text();this.options._CurrentFilter=$(a.currentTarget).text(),$.isPlainObject(this.options.Filters[0])?$(a.currentTarget).attr("menuopt_regex")?(b=$(a.currentTarget).attr("menuopt_regex"),this._process_matches(a,b,!1)):$(a.currentTarget).text().match(/\(all\)/i)?this._buildWholeDropDown(a):alert("Filter key "+$(a.currentTarget).text()+"does not have a matching regular expression"):$.inArray(b,this.options.Filters)>-1?this._process_matches(a,b,!1):this._buildWholeDropDown(a)}},_createFilterHeader:function(){var a=[],b=[];return $.isPlainObject(this.options.Filters[0])?($.each(this.options.Filters,function(c,d){b=$.map(d,function(a,b){return b}),a.push("	<td class=dflt id=hdr_fltr"+b[0]+' menuopt_regex="'+d[b[0]]+'">'+b[0]+"</td>\n")}),a.unshift("	<td class=dflt id=hdr_fltrAll>(all)</td>\n")):(a=$.map(this.options.Filters,function(a){return"	<td class=dflt>"+a+"</td>\n"}),a.unshift("	<td class=dflt>(all)</td>\n")),"\n<table id=HF_"+this._event_ns+" class=HdrFilter>\n<tr>\n"+a.join("")+"</tr>\n</table>\n"},_clear_filter:function(){this.options._CurrentFilter=""},_bind_events:function(){var a="",b={};a="mouseenter span#SP_"+this.options._ID+" table#HF_"+this._event_ns+" td.dflt",b[a]="_run_header_filter",a="click span#SP_"+this.options._ID+" table#HF_"+this._event_ns+" td.dflt",b[a]="_run_header_filter",a="mouseleave  span#SP_"+this.options._ID+" table#HF_"+this._event_ns+" td.dflt",b[a]="_clear_filter",this._on($("body"),b),this._on(this.cached[".clearBtn"],{mouseleave:"_hiLiteOnOff",mouseenter:"_hiLiteOnOff",click:function(a){$(this.element).val(""),$(this.element).attr("menu_opt_key",""),this._buildWholeDropDown(a)}}),this._on({mousedown:"_buildWholeDropDown",click:"_buildWholeDropDown",mouseenter:"_buildWholeDropDown",focus:"_buildWholeDropDown",input:"_buildWholeDropDown",search:"_buildWholeDropDown",mouseleave:"_removeDropDown",blur:"_removeDropDown"}),this._on($("body"),{"mouseleave span table.CrEaTeDtAbLeStYlE td.dflt":"_hiLiteOnOff","mouseenter span table.CrEaTeDtAbLeStYlE td.dflt":"_hiLiteOnOff"}),a="mousedown span#SP_"+this.options._ID+" table.CrEaTeDtAbLeStYlE td ",b[a]="_choice_selected",this._on($("body"),b),a="mouseleave span#SP_"+this.options._ID,b[a]="_removeDropDown",this._on($("body"),b),this._on(this.cached[".mo_elem"],{keypress:"_autocomplete",keydown:"_autocomplete",keyup:"_autocomplete"})},_arrow_keys:function(a){var b=a.keyCode,c=39,d=37,e=38,f=40,g=!1,h=this.options._currTD[0],i=this.options._currTD[1],j=$(".CrEaTeDtAbLeStYlE tr td.mo");if(/keydown|keyup/.test(a.type)){if(/keydown/.test(a.type)&&(b===c||b===d||b===e||b===f))return a.preventDefault(),!0;switch(a.keyCode){case $.ui.keyCode.TAB:return!1;case $.ui.keyCode.RIGHT:i<$(".CrEaTeDtAbLeStYlE tbody tr:nth-child(1) td").length&&(i=this.options._currTD[1]=this.options._currTD[1]+1),g=!0;break;case $.ui.keyCode.LEFT:i>1&&(i=this.options._currTD[1]=this.options._currTD[1]-1),g=!0;break;case $.ui.keyCode.UP:h>1&&(h=this.options._currTD[0]=this.options._currTD[0]-1),this.__scroll(h),g=!0;break;case $.ui.keyCode.DOWN:h<$(".CrEaTeDtAbLeStYlE tbody tr").length&&(this.options._currTD[0]+=1,h=this.options._currTD[0]),this.__scroll(h),g=!0;break;case $.ui.keyCode.ENTER:/divider/.test($(j).prop("class"))?g=!1:j.length>0&&(/Select/.test($(this.options)[0].MenuOptionsType)?this.__triggerChoice(a):/keydown/.test(a.type)&&this._run_menu_item(a)),a.preventDefault();break;case $.ui.keyCode.DELETE:$(this.options)[0].MenuOptionsType.match(/Select/i)&&0===this.cached[".mo_elem"].length&&(this.cached[".dropdownspan"].remove(),$(".CrEaTeDtAbLeStYlE tr td").removeClass("mo"),this._buildWholeDropDown(a))}if(g===!0)return $(".CrEaTeDtAbLeStYlE tr td").removeClass("mo"),$(".CrEaTeDtAbLeStYlE tr:nth-child("+h+") td:nth-child("+i+")").addClass("mo"),g}return!1},__scroll:function(a){var b=$(".CrEaTeDtAbLeStYlE tbody tr:nth-child("+a+")").offset().top,c=$(".CrEaTeDtAbLeStYlE tbody tr:nth-child("+a+")").height(),d=$("span#SP_"+this.options._ID).height(),e=$("span#SP_"+this.options._ID).offset().top;e>b?(this.options._vert_ofs-=c,$("span#SP_"+this.options._ID).scrollTop(this.options._vert_ofs)):b+c>e+d&&(this.options._vert_ofs+=c,$("span#SP_"+this.options._ID).scrollTop(this.options._vert_ofs))},_autocomplete:function(a){return/keydown|keyup/.test(a.type)&&this._arrow_keys(a)===!0||/Navigate/.test($(this.options)[0].MenuOptionsType)?void 0:(a.keyCode===$.ui.keyCode.ENTER&&a.preventDefault(),/keydown/.test(a.type)&&(this.cached[".mo_elem"].is(":visible")&&a.keyCode===$.ui.keyCode.ENTER||a.keyCode===$.ui.keyCode.TAB&&this.cached[".mo_elem"].val().length>0)?(this._process_matches(a,this.cached[".mo_elem"].val(),!0),void this.__triggerChoice(a)):void((/keyup/.test(a.type)||a.keyCode===$.ui.keyCode.BACKSPACE)&&this._process_matches(a,this.cached[".mo_elem"].val(),!0)))},_hiLiteOnOff:function(a){$(a.target).attr("class")&&($(a.target).attr("class").match(/clear_btn/)&&$(a.target).toggleClass("ClearButtonMO"),$(a.target).attr("class").match(/ *dflt */)&&("mouseenter"===a.type?$(a.target).addClass("mo"):$("span table.CrEaTeDtAbLeStYlE td.dflt").removeClass("mo")))},_refresh:function(){},_cache_elems:function(){var a=this.dropdownbox,b=this.dropdownbox.find("td"),c=this.element,d=$("div#CB_"+this._event_ns);this.cached={".dropdownspan":a,".dropdowncells":b,".clearBtn":d,".mo_elem":c}},_setOptions:function(){this._superApply(arguments),this._refresh()},_setOption:function(a,b){this._super(a,b)},_set_options:function(){this.options.ShowAt.match(/^ *bottom *$/i)?$("script[src*=bootstrap]").length>0?this._setOption("ShowAt","left bottom"):this._setOption("ShowAt","left bottom-2"):this.options.ShowAt.match(/^ *right *$/i)&&this._setOption("ShowAt","right-2 top"),this._initval_exists()&&this.set_select_value(this.options.InitialValue),this.options.SelectOnly&&$(this.element).prop("readonly",!0),this._setOption("Data",this.options.Data),this._setOption("_ID",this.eventNamespace.replace(/^\./,"")),this._setOption("_orig_bg",$(this.element).css("background-color"))},re_serialize:function(a){var b="";return $.each(a.split("&"),function(a,c){$.each(c.split("="),function(a,c){return b+=$('input[name="'+c+'"]')&&$('input[name="'+c+'"]').attr("menu_opt_key")?c+"="+$('input[name="'+c+'"]').attr("menu_opt_key")+"&":c+"="+$('input[name="'+c+'"]').val()+"&",!1})}),b.slice(0,-1)},_destroy:function(){$(this.element).removeClass("ui-menuoptions"),$("span#SP_"+this.options._ID).remove(),this._super()},_runSort:function(a){if(this.options.Sort.length>0){var b=this.options.Sort;b[0].match(/alpha/i)&&b[1].match(/asc/i)&&a.sort(function(a,b){return a.val>b.val?1:b.val>a.val?-1:0}),b[0].match(/alpha/i)&&b[1].match(/desc/i)&&a.sort(function(a,b){return a.val<b.val?1:b.val<a.val?-1:0}),b[0].match(/num/i)&&b[1].match(/asc/i)&&a.sort(function(a,b){return a-b}),b[0].match(/num/i)&&b[1].match(/desc/i)&&a.sort(function(a,b){return b-a})}},_build_row:function(a,b){return $.map(b,function(b){return!$.isFunction(b.ky)&&b.ky.match(/^ *divider *$/i)&&"Navigate"===a.options.MenuOptionsType?"	<td class="+b.ky+">"+b.val+"</td>\n":'	<td class=dflt menu_opt_key="'+b.ky+'">'+b.val+"</td>\n"})},_create_table:function(a){var b="",c=[],d=[],e=0,f=0,g="",h=0,i=/bottom/.test($(this.options)[0].ShowAt)?"bot":"rt";for(this._runSort(a),this.options.UseValueForKey===!0&&a.length===this.orig_objs.length&&$.each(a,function(a,b){b.val=b.ky});e*this.options.ColumnCount<a.length;){for(f=0===e?0:e*this.options.ColumnCount,c=a.slice(f,f+this.options.ColumnCount),d=this._build_row(this,c),h=c.length+1;h<=this.options.ColumnCount;h+=1)d.push('<td class=dflt menu_opt_key="">&nbsp;</td>');b+="<tr>\n"+d.join("")+"</tr>\n",e+=1}return b="<table class=CrEaTeDtAbLeStYlE cellpadding=4px>\n"+b+"</table>",this.options.Filters.length&&0===$(this.element).val().length&&(b=this._createFilterHeader()+b),g="<span class="+$(this.options)[0].MenuOptionsType+i+" id=SP_"+this.options._ID+">"+b+"\n</span>"},_add_clear_btn:function(){var a="";this.options.ClearBtn&&/Select/.test(this.options.MenuOptionsType)&&(a="<div class=clear_btn id=CB_"+this.eventNamespace.replace(/^\./,"")+"></div>",$(this.element).after(a),$("script[src*=bootstrap]").length>0&&$("div.clear_btn").css({width:"21px",height:"23px"})),this._show_menu_arrs()},_show_menu_arrs:function(){/Navigate/.test(this.options.MenuOptionsType)&&!/None/i.test(this.options.ShowDownArrow)&&(/button|img|div/i.test(this.element.prop("tagName"))?/^right/i.test(this.options.ShowAt)?(this.element.html(this.element.html()+"&nbsp;<span id=arr_"+this.options._ID+" class=right_arrow></span>"),$("#arr_"+this.options._ID+".right_arrow").css("border-left","4px solid "+this.options.ShowDownArrow)):(this.element.html(this.element.html()+"&nbsp;<span id=arr_"+this.options._ID+" class=down_arrow></span>"),$("#arr_"+this.options._ID+".down_arrow").css("border-top","4px solid "+this.options.ShowDownArrow)):($(this.element).html(this.element.text()+"&nbsp;<span id=arr_"+this.options._ID+" class=down_arrow></span>"),$("#arr_"+this.options._ID+".down_arrow").css("border-top","4px solid "+this.options.ShowDownArrow)))},_obj_create:function(a,b){var c;if($.isArray(b)===!0)a.push({ky:b[0],val:b[1]});else{if(c=$.map(b,function(a,b){return b}),!b.hasOwnProperty(c[0]))return alert("Data error: Key with no value error in incoming Data parameter"),!1;a.push({ky:c[0],val:b[c[0]]})}return!0},_build_array_of_objs:function(){var a=this,b=[];return"string"==typeof a.options.Data[0]?b=$.map(a.options.Data,function(a,b){return{ky:a,val:a}}):$.each(a.options.Data,function(c,d){if($.isArray(a.options.Data))if($.isPlainObject(a.options.Data[0])){if(a._obj_create(b,d)===!1)return!1}else $.isArray(a.options.Data[0])&&a._obj_create(b,d);else b.push({ky:c,val:d});a.total_rec_cnt+=1}),"Navigate"===a.options.MenuOptionsType&&(b=$.map(b,function(a){return{ky:a.val,val:a.ky}})),b},_run_menu_item:function(a){var b=$(a.target).text(),c=$(".CrEaTeDtAbLeStYlE tr td.mo"),d=[];c.length>0&&(b=c.text()),d=$.grep(this.ary_of_objs,function(a){return b===a.val.replace(/^< *img[\w\W]*?>/,"")}),d&&d.length>0&&($.isFunction(d[0].ky)?d[0].ky.call():$(a.target).attr("class").match(/^ *divider *$/i)||(/^new$/i.test(this.options.Window)?window.open(d[0].ky):window.open(d[0].ky,"_self")))},_choice_selected:function(a){var b=this,c="";this.cached[".dropdownspan"].remove(),($(a.currentTarget).text()!==this._prev_target||a.pageX!==this.options._prevXY.X||a.pageY!==this.options._prevXY.Y)&&(this._prev_target=$(a.currentTarget).text(),this.options._prevXY.X=a.pageX,this.options._prevXY.Y=a.pageY,this.options._prev_event=a.type,b=this,"Select"===b.options.MenuOptionsType?(c=$.trim($(a.currentTarget).text()),b.element.val(c),b._trigger("onSelect",b,{newCode:$(a.target).attr("menu_opt_key"),newVal:c,type:"Click"}),b.element.attr("menu_opt_key",$(a.target).attr("menu_opt_key")),a.target.className=a.target.className.replace(/ mo/,"")):this._run_menu_item(a),$(this.cached[".dropdowncells"]).removeClass("mo"),b.cached[".dropdownspan"].remove(),$(this.element).css({"border-color":this.options._orig_bg}))},_calcDropBoxCoordinates:function(){this.options._menu_box.top=this.cached[".dropdownspan"].position().top,this.options._menu_box.bottom=this.options._menu_box.top+this.cached[".dropdownspan"].height(),this.options._menu_box.left=this.cached[".dropdownspan"].position().left,this.options._menu_box.right=this.options._menu_box.left+this.cached[".dropdownspan"].width()},_didMouseExitDropDown:function(a){return a.pageX+1>this.options._menu_box.left&&a.pageX<this.options._menu_box.right-1&&a.pageY+1>this.options._menu_box.top&&a.pageY<this.options._menu_box.bottom?!1:!0},_removeDropDown:function(a){/Navigate/.test($(this.options)[0].MenuOptionsType)&&/mouseleave/.test(a.type)&&($(this.options)[0]._curr_img=null),this.options._prev_event=a.type,("blur"!==a.type||"mouseleave"!==this.options._prev_event)&&$("span#SP_"+this.options._ID).length&&this._didMouseExitDropDown(a)===!0&&this.cached[".dropdownspan"].remove()},_resetOffsetOfDropDown:function(){(this.menu_start_loc.left!==this.cached[".dropdownspan"].offset().left||this.menu_start_loc.top!==this.cached[".dropdownspan"].offset().top)&&this.cached[".dropdownspan"]&&this.cached[".dropdownspan"][0]&&(this.options._width_adj.width_adjustment=parseInt(this.cached[".dropdownspan"][0].style.left,10)+(this.options._width_adj.width_after_adj-this.options._width_adj.width_menu)/2,this.cached[".dropdownspan"].css({left:this.options._width_adj.width_adjustment}))},_addDropDownToDOM:function(){$('body span[id^="SP_menuoption"]').remove(),this.dropdownbox.appendTo("body").hide(1)},_show_drop_down:function(){var a=this,b=0;this._addDropDownToDOM(),this._get_n_set_width(),a.cached[".dropdownspan"].stop(!0,!1).show().position({of:this.element,my:"left top",at:a.options.ShowAt,collision:"flipfit"}),b=parseInt($("span#SP_"+this.options._ID).css("width"),10),$("span#SP_"+a.options._ID).css({zIndex:9999}),this._use_scroller()&&($("span#SP_"+a.options._ID).css({"overflow-y":"scroll","overflow-x":"hidden",width:b+18,height:parseInt(a.options.Height,10)}),a.cached[".dropdownspan"].stop(!0,!1).show().position({of:this.element,my:"left top",at:a.options.ShowAt,collision:"flipfit"})),$("table.CrEaTeDtAbLeStYlE").find("tr:even").addClass("even"),$("table.CrEaTeDtAbLeStYlE").find("tr:odd").addClass("odd"),this._refresh(),this._calcDropBoxCoordinates()},_use_scroller:function(){var a=parseInt($("span#SP_"+this.options._ID).css("height"),10);return/Select/i.test(this.options.MenuOptionsType)&&/^\d+/.test(this.options.Height)&&parseInt(this.options.Height,10)<a},_get_n_set_width:function(){var a=this,b=parseInt($("span#SP_"+this.options._ID).css("width"),10);a.menu_start_loc=a.cached[".dropdownspan"].offset(),a.options._width_adj.width_menu=b,a.options._width_adj.width_after_adj=b>$(this.element).width()?b:$(this.element).outerWidth(),""!==a.options.Width&&0!==a.options.Width&&(a.options._width_adj.width_after_adj=parseInt(a.options.Width,10)),$("span#SP_"+a.options._ID+", span#SP_"+a.options._ID+" > table").css({width:a.options._width_adj.width_after_adj}),this.options.ShowAt.match(/left[\w\W]*bottom[\w\W]*/i)?$("span#SP_"+a.options._ID).offset({left:$(this.element).offset().left}):$("span#SP_"+a.options._ID).offset({left:$(this.element).offset().left+$(this.element).outerWidth()})}});