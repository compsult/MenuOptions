<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title> Reload MenuOptions Slelect demo</title>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
   <script src="../media/javascript/jquery.menuoptions.js?v_2359"></script> 
   <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/themes/smoothness/jquery-ui.css" />
   <link rel="stylesheet" href="../media/style/menuoptions.css?v_2359">
   <style>
   h1 { color: gray; font-size:26px; } 
   h2 { color: gray; font-size:16px; } 
   button.a { background-image:url('images/greenbutton.png') ; padding:2px; border:2px outset beige;cursor:pointer; width:170px; height:30px; -moz-border-radius: 9px; -webkit-border-radius: 9px; }
   </style>
  

<script type='text/javascript'>//<![CDATA[ 
$(document).ready(function() {
    function get_hh_mm ( value ) {
        var hh = new Date(value).getHours(),
            ampm = "PM",
            mm = new Date(value).getMinutes();
        if ( hh < 12 ) { ampm = "AM";
        } else { hh -= 12; }
        hh = ( hh === 0 ) ? "12" : hh;
        hh = ( hh < 10 ) ? "0" + hh : hh;
        mm = ( mm < 10 ) ? "0" + mm : mm;
        return hh + ":" + mm + " " + ampm;
    }
    var AddApptMins = function ( StartTime, Duration ) {
        var epoch_time = new Date("Jan 1, " + new Date().getFullYear() + " " + StartTime).getTime() + Duration * 60000;
        return get_hh_mm ( epoch_time );
    }
    var last_time = ""
        earliest_time = '08:00 AM',
        latest_time = '09:45 PM';
    $("body").data("alltimes", [ earliest_time ]);
    for (var t = 0; t <= 80; t += 1) {  
       last_time = AddApptMins($("body").data("alltimes")[$("body").data("alltimes").length-1], 15);
       $("body").data("alltimes").push(last_time);   
       if ( last_time === latest_time ) { break; }
    }  
    $('input#starttime').menuoptions({
                                    "Data": $("body").data("alltimes"),
                                    "Filters": [{'AM':'AM'},{'PM':'PM'}],
                                    "ClearBtn": true,
                                    "PlaceHolder": "Start time",
                                    "onSelect": function(e, data) { 
                                        ResetEndTimeData(data.newVal); 
                                    }, 
                                    "ShowAt": 'bottom',
                                    "ColumnCount": 4,
                                    "Width": 300,
                                    "TriggerEvent": "change",
                                    "Sort": []
                                    });
    $('input#endtime').menuoptions({
                                    "Data": $("body").data("alltimes"),
                                    "Filters": [{'AM':'AM'},{'PM':'PM'}],
                                    "ClearBtn": true,
                                    "PlaceHolder": "End time",
                                    "ShowAt": 'bottom',
                                    "ColumnCount": 4,
                                    "Width": 300,
                                    "TriggerEvent": "change",
                                    "Sort": []
                                    });
    function ResetEndTimeData( startTime ) {
          var end_time = $('input#endtime');
          /*--  clear out the existing end time array  --*/
          $("body").data("endtimes", []);
          /*--  change end time choices to be up to 90 minutes later   --*/
          for (var t = 0; t <= 90; t += 5) { 
            $("body").data("endtimes").push(AddApptMins(startTime, t)); 
          } 
          /*--  refresh the Data for the endtime and remove filters (AM|PM)   --*/
	      $('input#endtime').menuoptions( 'refreshData',  
                { 'Data'    : $("body").data("endtimes"),
                  'Filters' : [],
                  'ColumnCount' : 4,
                  'Width' : 300 });
    }
    $('button#menutest').on('click', function (e) {
        var tst = $('input#starttime').menuoptions('re_serialize',$('form#tst').serialize()); 
        alert (tst);
    });
});
</script>
</head>
<body style="background:white; text-align:center; overflow:hidden; margin: 0px auto;  padding: 0px; width: 920px;">
	<br><h1 >Example of dynamic reloading a MenuOptions select</h1> 
    <h2>When you change the Start time, the end time select list will modified to <br /> 
        only display the start time plus 1 hour and 30 minutes </h2><br />
    <form id=tst>
	 <table style="margin: 0 auto;">
	    <tr>
	       <td class=demotd1>
		      <input name=starttime id='starttime' type='search' >
	       </td>
	    </tr>
	    <tr>
	       <td class=demotd1>
		      &nbsp;
	       </td>
	    </tr>
	    <tr>
	       <td class=demotd1>
		      <input name=endtime id='endtime' type='search' >
	       </td>
	    </tr>
	    <tr>
	       <td class=demotd1>
		      &nbsp;
	       </td>
	    </tr>
	    <tr>
	       <td class=demotd1>
            <button class=a type="button" id="menutest" >Show serialize values</button>
	       </td>
	    </tr>
	 </table>
    </form>
    </body>
</html>

