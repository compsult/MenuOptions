/*! menuoptions 2016-06-30 */
"use strict";$.widget("mre.menuoptions",{options:{BootMenuOfs:140,ClearBtn:!1,Data:"",ColumnCount:1,DataKeyNames:{},DisableHiLiting:!1,Filters:[],Height:"",Help:"",InitialValue:{},MenuOptionsType:"Select",ShowAt:"bottom",Sort:["alpha","asc"],SelectOnly:!1,ShowDownArrow:"black",UseValueForKey:!1,Mask:"",Width:"",Window:"repl",_mask:{},_ID:"UnIqDrOpDoWnSeLeCt",_bootstrap:!1,_vert_ofs:0,_prev:{event:"",text:""},_mask_status:{mask_only:!1,mask_passed:!1},_CurrentFilter:"",_currTD:[0,1],_event_ns:"",_menu_box:{top:0,bottom:0,left:0,right:0},_width_adj:{width_menu:0,width_adjustment:0,width_after_adj:0}},_create:function(){if(""===this.options.Data.toString()){if(""===this.options.Mask)return this._validation_fail("MenuOptions requires the Data parameter to be populated","fatal");this.options._mask_status.mask_only=!0}if(this.options.ColumnCount<1)return this._validation_fail("MenuOptions requires ColumnCount parameter be > 0","fatal");if(this.options._mask_status.mask_only===!1){if(this._check_for_bootstrap(),this._build_array_of_objs(),this.orig_objs===!1)return this._validation_fail("Invalid Data format supplied to menuoptions","fatal");if(/Rocker/i.test(this.options.MenuOptionsType)&&2!==this.orig_objs.length)return this._validation_fail("When using the rocker control, exactly 2 elements need to be supplied to menuoptions","fatal")}this._setOptions(this.options),this._bind_events(),this._refresh(),this._detect_destroyed_input(),$(this.element).addClass("ui-menuoptions")},_add_clear_btn:function(){var a="",b="";this.options.ClearBtn&&/Select/.test(this.options.MenuOptionsType)&&(b="CB_"+this.options._ID,0===$("span#"+b).length&&(a='<span class="clearbtn clearbtnpos" id='+b+">X</span>",$(this.element).after(a)),$("span#"+b).position({of:$(this.element),my:"center center",at:"right-10"})),this._show_help()},_show_help:function(){var a="HLP_"+this.options._ID,b=this.options._mask.hasOwnProperty("Help")?this.options._mask.Help:"";if(0===$("span#"+a).length){var c="<span class=helptext id="+a+">"+b+"</span>";$(this.element).after(c),$("span#"+a).position({of:$(this.element),my:"center center-8",at:"right+4"})}$("span#HLP_"+this.options._ID).hide()},_validation_fail:function(a,b){var c="input id #"+$(this.element).attr("id")+": ";return alert(c+a),/fatal/i.test(b)&&this._destroy(),!1},_mask_vars:function(){return{"HH:MM AM":{MaxLen:8,Help:"HH:MM AM",hotkey:{1:function(a,b){return b._date_hotkeys({val:a,ofs:1,fmt:"H:M"})}},valid:{1:{max_val:1},2:function(a,b){return/1/.test(a[0])?b._day_test(a,2,"cut",1):b._day_test(a,9,"cut",1)},4:{max_val:5},5:{max_val:9},7:function(a,b){return b._is_char_valid(a,"AP","A or P only","one_char",6)},8:function(a,b){return b._is_char_valid(a,"M","M only","one_char",7)}},consts:{3:":",6:" ",8:"M"},Whole:function(a,b){return/^[01][0-9]:[0-5][0-9] [AP]M$/.test(a)}},"Mon DD, YYYY":{MaxLen:12,Help:"Mon DD, YYYY",hotkey:{1:function(a,b){return b._date_hotkeys({val:a,ofs:1,fmt:"MdY"})},2:function(a,b){return b._date_hotkeys({val:a,ofs:2,fmt:"MdY"})}},valid:{1:function(a,b){return b._is_char_valid(a,"JFMASOND","invalid month","one_char",0)},2:function(a,b){return b._is_char_valid(a.substring(0,2),"Ja|Fe|Ma|Ap|Ju|Au|Se|Oc|No|De","invalid month","string",0)},3:function(a,b){return b._is_char_valid(a.substring(0,3),"Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec","invalid month","string",0)},5:function(a,b){return b._get_days(a,"MdY")},6:function(a,b){return b._get_days(a,"MdY")},9:{max_val:9},10:{max_val:9},11:{max_val:9},12:{max_val:9}},consts:{4:" ",7:",",8:" "},Whole:function(a,b){return b._get_days(a,"MdY")}},YYYYMMDD:{MaxLen:8,Help:"YYYYMMDD",hotkey:{1:function(a,b){return b._date_hotkeys({val:a,ofs:1,fmt:"YMD"})}},valid:{1:{max_val:9},2:{max_val:9},3:{max_val:9},4:{max_val:9},5:{max_val:1},6:function(a,b){return/1/.test(a[4])?b._day_test(a,2,"cut",5):b._day_test(a,9,"cut",5)},7:function(a,b){return b._get_days(a,"YMD")},8:function(a,b){return b._get_days(a,"YMD")}},Whole:function(a,b){return b._get_days(a,"YMD")}},"(999) 999-9999":{MaxLen:14,Help:"(999) 999-9999",valid:{2:{max_val:9},3:{max_val:9},4:{max_val:9},7:{max_val:9},8:{max_val:9},9:{max_val:9},11:{max_val:9},12:{max_val:9},13:{max_val:9},14:{max_val:9}},consts:{1:"(",5:")",6:" ",10:"-"},Whole:"^\\([0-9]{3}\\) [0-9]{3}-[0-9]{4}$"}}},_set_valid_mask:function(){var a=this._mask_vars();if(this.options.Mask.length>0){if(!a.hasOwnProperty(this.options.Mask))return this._validation_fail(this.options.Mask+" is not a valid mask.","fatal");this.options._mask=a[this.options.Mask],$(this.element).prop("maxLength",this.options._mask.MaxLen)}},_check_for_bootstrap:function(a){$("script[src*=bootstrap]").length>0&&(this.options._bootstrap=!0)},refreshData:function(a){this._setOptions(a)},add_menuoption_key:function(){var a=this._match_list_hilited({StrToCheck:this.element.val(),chk_key:!0,case_ins:!1});if(a.length>0){var b=a[0].val.toString().replace(/<[\w\W]*?>/g,"");/Rocker/i.test(this.options.MenuOptionsType)?this._set_rocker(a,b):($(this.element).removeAttr("value"),$(this.element).val(b),$(this.element).attr("menu_opt_key",a[0].ky),$(this.element).removeClass("data_error").addClass("data_good"))}else $(this.element).val().length>0&&$(this.element).removeClass("data_good").addClass("data_error");this._add_clear_btn()},set_select_value:function(a){var b="",c={};a.hasOwnProperty("ky")?(c=$.grep(this.ary_of_objs,function(b){return parseInt(b.ky,10)===parseInt(a.ky,10)}),b=c[0].val):b=a.val,/Rocker/i.test(this.options.MenuOptionsType)?null!==b&&""===b?($(this.element).attr("menu_opt_key",""),$("div#RK_RT_"+this._event_ns).attr("class","rtup"),$("div#RK_LT_"+this._event_ns).attr("class","ltup")):this._change_rocker($(this.element).parent().find("span:contains("+b+")").parent()):(this.element.val(b),b.length>0?this.add_menuoption_key():$(this.element).removeClass("data_error data_good"))},_create_rocker:function(){var a="rtup",b="ltup",c=this.cached[".mo_elem"].val();this.cached[".mo_elem"].hide(),this.cached[".mo_elem"].next("span.clearbtn").hide(),this._event_ns=this.eventNamespace.replace(/^\./,""),this._initval_exists()&&this.set_select_value(this.options.InitialValue),c.length>0&&new RegExp(c).test(this.orig_objs[0].val)&&(b="ltdown"),c.length>0&&new RegExp(c).test(this.orig_objs[1].val)&&(a="rtdown"),this.cached[".mo_elem"].parent().append("<div class=rocker id=RK_"+this._event_ns+"><div id=RK_LT_"+this._event_ns+" class="+b+" menu_opt_key="+this.orig_objs[0].ky+"></div><div id=RK_RT_"+this._event_ns+" class="+a+" menu_opt_key="+this.orig_objs[1].ky+"></div></div></div>"),$("div#RK_LT_"+this._event_ns).append("<span class=innertext>"+this.orig_objs[0].val+"</span>"),$("div#RK_RT_"+this._event_ns).append("<span class=innertext>"+this.orig_objs[1].val+"</span>")},_rocker_click:function(a){var b=$(a.target).is("[menu_opt_key]")?$(a.target):$(a.target.parentElement);this._change_rocker(b),this.__exec_trigger({newCode:b.attr("menu_opt_key"),newVal:b.children().text(),type:"RockerClick"})},_set_rocker:function(a,b){this.cached[".mo_elem"].attr("menu_opt_key",a[0].ky),this.cached[".mo_elem"].val(b),new RegExp(b).test($("div#RK_RT_"+this.options._ID+" span").text())?($("div#RK_RT_"+this.options._ID).attr("class","rtdown"),$("div#RK_LT_"+this.options._ID).attr("class","ltup")):new RegExp(b).test($("div#RK_LT_"+this.options._ID+" span").text())&&($("div#RK_RT_"+this.options._ID).attr("class","rtup"),$("div#RK_LT_"+this.options._ID).attr("class","ltdown"))},_change_rocker:function(a){this.cached[".mo_elem"].attr("menu_opt_key",a.attr("menu_opt_key")),this.cached[".mo_elem"].val(a.find("span").text()),/ltup/.test(a.attr("class"))?($("div#RK_LT_"+this._event_ns).attr("class","ltdown"),$("div#RK_RT_"+this._event_ns).attr("class","rtup")):/rtup/.test(a.attr("class"))&&($("div#RK_LT_"+this._event_ns).attr("class","ltup"),$("div#RK_RT_"+this._event_ns).attr("class","rtdown"))},_rocker_main:function(a){$("span#CB_"+this.options._ID).remove(),$("div.rocker[id=RK_"+this._event_ns+"]").length&&$("div.rocker[id=RK_"+this._event_ns+"]").remove(),this._create_rocker(),this._bind_rocker(),a.val.length>0&&this.set_select_value(a)},_bind_rocker:function(){this._on($("div[id$=T_"+this._event_ns+"]"),{click:"_rocker_click"})},_initval_exists:function(){var a=!1;return(this.options.InitialValue.hasOwnProperty("val")&&this.options.InitialValue.val.length>=0||this.options.InitialValue.hasOwnProperty("ky")&&this.options.InitialValue.ky.length>0)&&(a=!0),a},_detect_destroyed_input:function(){$(this.element).bind("remove",function(){this._destroy()})},__exec_trigger:function(a){var b=$.trim(a.newVal);this.cached[".mo_elem"].val(b),this.cached[".mo_elem"].attr("menu_opt_key",a.newCode),this._trigger("onSelect",this,{newCode:a.newCode,newVal:b,type:a.type}),/Rocker/i.test(this.options.MenuOptionsType)||(this.cached[".mo_elem"].removeClass("data_error").addClass("data_good"),$("span#HLP_"+this.options._ID).show().html("&nbsp;").removeClass("helptext err_text").addClass("mask_match"))},_run_menu_item:function(a){var b=$(a.target).text(),c=$(".CrEaTeDtAbLeStYlE tr td.mo"),d=[];c.length>0&&(b=c.text()),d=$.grep(this.ary_of_objs,function(a){return b===a.val.replace(/^< *img[\w\W]*?>/,"")}),d&&d.length>0&&($.isFunction(d[0].ky)?d[0].ky.call():$(a.target).hasOwnProperty("class")&&/^divider$/i.test(a.target.attr("class"))||(/^new$/i.test(this.options.Window)?window.open(d[0].ky):window.open(d[0].ky,"_self")))},_choice_selected:function(a){/^ *divider *$/i.test($(a.target).attr("class"))||(this.options._prev.event=a.type,/Select/i.test(this.options.MenuOptionsType)?(this.__exec_trigger({newCode:$(a.target).closest("td").attr("menu_opt_key"),newVal:$(a.target).closest("td").text(),type:"Click"}),a.target.className=a.target.className.replace(/ mo/,"")):this._run_menu_item(a),$(this.cached[".dropdowncells"]).removeClass("mo"),$("span#SP_"+this.options._ID).remove())},_check_mask:function(a){(this.cached[".mo_elem"].val().length!==this.options._mask.MaxLen||this._match_complete()!==!0)&&this._is_last_mask_char_valid(a,this.cached[".mo_elem"].val())},_match_complete:function(){if(this.options._mask.hasOwnProperty("Whole")===!1||this.options._mask.hasOwnProperty("MaxLen")===!1)return!1;var a=this.cached[".mo_elem"].val();return a.length===this.options._mask.MaxLen?$.isFunction(this.options._mask.Whole)&&this.options._mask.Whole(a,this)===!0?(this.__set_help_msg("","completed"),!0):new RegExp(this.options._mask.Whole).test(a)===!0?(this.__set_help_msg("","completed"),!0):!1:void 0},_build_match_ary:function(a,b){var c=this._match_list_hilited({StrToCheck:b,chk_key:!1,case_ins:!0,evt:a});if(/Select/.test(this.options.MenuOptionsType)&&0===c.length&&""===this.options._CurrentFilter){if(this._is_last_mask_char_valid(a,b)!==!0)return this._match_list_hilited({StrToCheck:this.cached[".mo_elem"].val(),chk_key:!1,case_ins:!0,evt:a});this._match_complete()}return c},_add_const:function(a){var b=a.length;if(this.options._mask.hasOwnProperty("consts"))for(;b<this.options._mask.MaxLen&&this.options._mask.consts.hasOwnProperty(b+1);b++)if(this.cached[".mo_elem"].val(this.cached[".mo_elem"].val()+this.options._mask.consts[b+1]),this._match_complete()===!0)return!0;return!1},_match_list_hilited:function(a){if(/Select|Rocker/.test(this.options.MenuOptionsType)&&0===a.StrToCheck.length)return[];if(/Select/.test(this.options.MenuOptionsType)&&""===this.options._CurrentFilter&&this.options.Mask.length>0&&a.evt.type.length>0&&/keyup/.test(a.evt.type)){if(this._is_last_mask_char_valid(a.evt,a.StrToCheck)!==!0)return[];this._add_const(this.cached[".mo_elem"].val())}var b="",c="",d="",e=/(\{|\}|\\|\*|\(|\))|\[|\]/g;/Navigate/i.test(this.options.MenuOptionsType)||(a.StrToCheck=a.StrToCheck.replace(e,"\\$&"));var f=a.case_ins?new RegExp(a.StrToCheck,"i"):new RegExp(a.StrToCheck),g=$.map(this.orig_objs,function(e){return c=e.val.replace(/<img[\w\W]*?>/,""),a.chk_key&&f.test(e.ky.toString())?e:f.test(c)?(d=c.replace(f,'<span style="color:brown;font-size:110%;">'+f.exec(c)[0]+"</span>"),b=e.val.match(/<img[\w\W]*?>/),b&&(d=b+d),{ky:e.ky,val:d}):void 0});return 0===this.options._CurrentFilter.length&&this.__check_match_results(g,a.StrToCheck,a.evt),g},__check_match_results:function(a,b,c){0===a.length?0===this.options.Mask.length&&this._cut_last_char(b,"invalid key",c):b===a[0].val.replace(/<span[\w\W]*?>|<\/span>/g,"")?this.__set_help_msg("","completed"):a.length>1?this.cached[".mo_elem"].removeClass("data_good").addClass("data_error"):this.__set_help_msg("","good")},__set_help_msg:function(a,b){switch(b){case"error":$("span#HLP_"+this.options._ID).show().html('<span style="margin-left:16px">'+a+"</span>").removeClass("helptext mask_match").addClass("err_text"),this.cached[".mo_elem"].removeClass("data_good").addClass("data_error");break;case"completed":if($("span#HLP_"+this.options._ID).hasOwnProperty("background-image")&&$("span#HLP_"+this.options._ID).css("background-image").match("greencheck.png"))return void $("span#HLP_"+this.options._ID).show();this.cached[".mo_elem"].removeClass("data_error").addClass("data_good"),$("span#HLP_"+this.options._ID).show().html("&nbsp;").removeClass("helptext err_text").addClass("mask_match");var c=this.cached[".mo_elem"].val();this.options._mask_status.mask_passed=!0,this.__exec_trigger({newCode:c,newVal:c,type:"Completed"});break;case"good":a=this.options._mask.hasOwnProperty("Help")?this.options._mask.Help:"",$("span#HLP_"+this.options._ID).show().html(a).removeClass("err_text mask_match").addClass("helptext")}0===this.cached[".mo_elem"].val().length?this.cached[".mo_elem"].removeClass("data_good data_error"):this.cached[".mo_elem"].val().length<this.options._mask.MaxLen&&this.cached[".mo_elem"].removeClass("data_good").addClass("data_error")},_matches:function(a,b){return $.map(this.orig_objs,function(c){return"exact"===b&&a===c.val.replace(/<img[\w\W]*?>/,"")?c:"partial"===b&&new RegExp(a).test(c.val.replace(/<img[\w\W]*?>/,""))?c:void 0})},_cut_last_char:function(a,b,c){this.cached[".mo_elem"].val(a.slice(0,-1)),this.__set_help_msg(b,"error")},_run_valid_mask_test:function(a,b,c){if(this.options._mask.hasOwnProperty("consts")&&this.options._mask.consts[c])this.cached[".mo_elem"].val().substring(c-1,c)!==this.options._mask.consts[c]&&this.cached[".mo_elem"].val(this.cached[".mo_elem"].val().substring(0,c-1));else if(this.options._mask.hasOwnProperty("valid")&&this.options._mask.valid.hasOwnProperty(c))if($.isFunction(this.options._mask.valid[c]))this.options._mask.valid[c](this.cached[".mo_elem"].val(),this);else if(this.options._mask.valid[c].hasOwnProperty("max_val")){var d=this.options._mask.valid[c].max_val;new RegExp("[0-"+d+"]").test(this.cached[".mo_elem"].val()[c-1])||(this.cached[".mo_elem"].val(this.cached[".mo_elem"].val().substring(0,c-1)),this.__set_help_msg("0 - "+d+" only","error"))}},_valid_test:function(a,b){var c=b.length;b.length>this.options._mask.MaxLen&&this.cached[".mo_elem"].val(b.substring(0,this.options._mask.MaxLen));for(;c>0;c--)if(this._run_valid_mask_test(a,b,c),0===this.cached[".mo_elem"].val().length)return!0;return this._add_const(this.cached[".mo_elem"].val()),this.__set_help_msg("",""),!0},_is_last_mask_char_valid:function(a,b){return b.length>this.options._mask.MaxLen?(this.cached[".mo_elem"].val(b.substring(0,this.options._mask.MaxLen)),!0):this.options._mask.hasOwnProperty("hotkey")&&this.options._mask.hotkey.hasOwnProperty(b.length)&&this.options._mask.hotkey[b.length](b,this)===!0?(this.__set_help_msg("","good"),!0):this.options._mask.hasOwnProperty("valid")&&this.options._mask.valid.hasOwnProperty(b.length)||this.options._mask.hasOwnProperty("consts")&&this.options._mask.consts.hasOwnProperty(b.length)?this._valid_test(a,b):void 0},_process_matches:function(a,b){var c=[];""!==b&&(c=this._build_match_ary(a,b),this.cached[".dropdownspan"].remove()),c.length>0?this._build_filtered_dropdown(a,c):this._buildWholeDropDown(a)},_tab_and_enter_keypress:function(a,b){if(a.keyCode===$.ui.keyCode.ENTER)a.preventDefault(),this.__exec_trigger({newCode:$("table.CrEaTeDtAbLeStYlE td:first").attr("menu_opt_key"),newVal:$("table.CrEaTeDtAbLeStYlE td:first").text(),type:"ENTERKey"});else if(a.keyCode===$.ui.keyCode.TAB&&b.length>0){var c=this._build_match_ary(a,b);c.length>0?this.__exec_trigger({newCode:$("table.CrEaTeDtAbLeStYlE td:first").attr("menu_opt_key"),newVal:$("table.CrEaTeDtAbLeStYlE td:first").text(),type:"TABKey"}):this.__match_complete()===!0&&this.__exec_trigger({newCode:b,newVal:b,type:"TABKey"})}this.__set_help_msg("","")},_clear_filter:function(a){this.options._CurrentFilter=""},_bind_events:function(){var a="",b={};a="mouseenter span#SP_"+this.options._ID+" table.CrEaTeDtAbLeStYlE td.dflt",b[a]="_hiLiteOnOff",a="mouseenter span#SP_"+this.options._ID+" table#HF_"+this._event_ns+" td.hf_td",b[a]="_run_header_filter",a="click button.navbar-toggle",b[a]="_removeDropDown",a="mousedown span#SP_"+this.options._ID+" table.CrEaTeDtAbLeStYlE td ",b[a]="_choice_selected",a="mouseleave span#SP_"+this.options._ID,b[a]="_removeDropDown",this._on($("body"),b),this._on(this.cached[".clearBtn"],{mouseleave:"_hiLiteOnOff",mouseenter:"_hiLiteOnOff",mousedown:"_clearInput",click:"_clearInput"}),this._on({touchend:"_buildWholeDropDown",mousedown:"_buildWholeDropDown",click:"_buildWholeDropDown",mouseenter:"_buildWholeDropDown",focus:"_buildWholeDropDown",keypress:"_buildWholeDropDown",keydown:"_buildWholeDropDown",input:"_buildWholeDropDown",keyup:"_buildWholeDropDown",search:"_buildWholeDropDown",mouseleave:"_removeDropDown",blur:"_removeDropDown"})},_clearInput:function(a){var b=this;$(this.element).prop("disabled")||($(this.element).attr("menu_opt_key",""),$(this.element).val(""),setTimeout(function(){$(b.element).focus()},80),$(this.element).removeClass("data_error data_good"),this.__set_help_msg("","good"))},_arrow_keys:function(a){var b=!1,c=this.options._currTD[0],d=this.options._currTD[1],e=$(".CrEaTeDtAbLeStYlE tr td.mo");if(/keydown|keyup/.test(a.type)){if(/keyup/.test(a.type)&&/^(37|38|39|40|8)$/.test(a.keyCode))return a.preventDefault(),!0;switch(a.keyCode){case $.ui.keyCode.TAB:return!1;case $.ui.keyCode.RIGHT:d<$(".CrEaTeDtAbLeStYlE tbody tr:nth-child(1) td").length&&(d=this.options._currTD[1]=this.options._currTD[1]+1),b=!0;break;case $.ui.keyCode.LEFT:d>1&&(d=this.options._currTD[1]=this.options._currTD[1]-1),b=!0;break;case $.ui.keyCode.UP:c>1&&(c=this.options._currTD[0]=this.options._currTD[0]-1),this.__scroll(c),b=!0;break;case $.ui.keyCode.DOWN:c<$(".CrEaTeDtAbLeStYlE tbody tr").length&&(this.options._currTD[0]+=1,c=this.options._currTD[0]),this.__scroll(c),b=!0;break;case $.ui.keyCode.BACKSPACE:a.preventDefault(),this._back_space(this.cached[".mo_elem"].val()),b=!0;break;case $.ui.keyCode.ENTER:/divider/.test($(e).prop("class"))?b=!1:e.length>0&&(/Select/.test(this.options.MenuOptionsType)?this.__exec_trigger({newCode:$(".CrEaTeDtAbLeStYlE tr td.mo").attr("menu_opt_key"),newVal:$(".CrEaTeDtAbLeStYlE tr td.mo").text(),type:"EnterKey"}):/keydown/.test(a.type)&&this._run_menu_item(a))}if(b===!0)return $(".CrEaTeDtAbLeStYlE tr td").removeClass("mo"),$(".CrEaTeDtAbLeStYlE tr:nth-child("+c+") td:nth-child("+d+")").addClass("mo"),b}return!1},_back_space:function(a){for(var b=a.length;b>0;b--){if(!this.options._mask.hasOwnProperty("consts")||!this.options._mask.consts.hasOwnProperty(b)){$(this.element).val(this.cached[".mo_elem"].val().substring(0,b-1));break}b>1&&$(this.element).val(this.cached[".mo_elem"].val().substring(0,b-1))}this.__set_help_msg("","")},__set_prev:function(a){this.options._prev.event=a.type,this.options._prev.text=$(a.currentTarget).text()},_hiLiteOnOff:function(a){return a.type===this.options._prev.event&&$(a.currentTarget).text()===this.options._prev.text?this.__set_prev(a):(this.__set_prev(a),void($(a.target).attr("class")&&($(a.target).attr("class").match(/clearbtn/)?"mouseenter"===a.type?$(a.target).addClass("ClearButtonMO"):$(a.target).removeClass("ClearButtonMO"):$(a.target).attr("class").match(/ *dflt */)&&($("span table.CrEaTeDtAbLeStYlE td.dflt").removeClass("mo"),$(a.target).addClass("mo")))))},_refresh:function(){},_cache_elems:function(){this.cached[".dropdownspan"]=this.dropdownbox,this.cached[".dropdowncells"]=this.dropdownbox.find("td"),this.cached[".clearBtn"]=$("span#CB_"+this._event_ns),this.cached[".mo_elem"]=this.element},_recreate_mo:function(){var a=$(this.element).val();this._build_array_of_objs(),/Rocker/i.test(this.options.MenuOptionsType)?this._rocker_main({val:a}):($("div.rocker[id=RK_"+this._event_ns+"]").length&&($("div.rocker[id=RK_"+this._event_ns+"]").remove(),$(this.element).show(),$(this.element).next("span.clearbtn").show()),/Select/.test(this.options.MenuOptionsType)?(this._set_valid_mask(),$(this.element).attr("autocomplete","off"),this._add_clear_btn()):/Navigate/.test(this.options.MenuOptionsType)&&this._show_menu_arrs(),this._build_dropdown(this.orig_objs))},_setOptions:function(a){this.cached={".mo_elem":this.element},this._setOption("_ID",this.eventNamespace.replace(/^\./,""));var b=this;/Select|Rocker/.test(this.options.MenuOptionsType)&&(this.add_menuoption_key(),0===Object.keys(a).length)||(this.options._orig_showat=this.options.ShowAt,$.each(a,function(c,d){b.options.hasOwnProperty(c)&&b._setOption(c,a[c])}),this._set_showat(),this._initval_exists()&&this.set_select_value(this.options.InitialValue),this.options.SelectOnly&&$(this.element).prop("readonly",!0),this._recreate_mo())},re_serialize:function(a){var b="";return $.each(a.split("&"),function(a,c){$.each(c.split("="),function(a,c){return b+=$('input[name="'+c+'"]')&&$('input[name="'+c+'"]').attr("menu_opt_key")?c+"="+$('input[name="'+c+'"]').attr("menu_opt_key")+"&":c+"="+$('input[name="'+c+'"]').val()+"&",!1})}),b.slice(0,-1)},_destroy:function(){$(this.element).removeClass("ui-menuoptions"),$("span#SP_"+this.options._ID).remove(),this._super()},__set_arrow:function(a){var b=/down/.test(a)?"top":"left";$('span[id="arr_'+this.options._ID+'"]').remove(),$(this.element).children("span.ui-button-text").length>0?$(this.element).children("span.ui-button-text").append("<span id=arr_"+this.options._ID+" class="+a+"_arrow></span>"):this.element.append("<span id=arr_"+this.options._ID+" class="+a+"_arrow></span>"),$("#arr_"+this.options._ID+"."+a+"_arrow").css("border-"+b,"4px solid "+this.options.ShowDownArrow)},_show_menu_arrs:function(){/Navigate/.test(this.options.MenuOptionsType)&&!/None/i.test(this.options.ShowDownArrow)&&($("button.navbar-toggle").length&&/block/.test($("button.navbar-toggle").css("display"))&&$(this.element).closest("ul.navbar-nav").length?this.__set_arrow("right"):/^right/i.test(this.options.ShowAt)?this.__set_arrow("right"):this.__set_arrow("down"))},_build_array_of_objs:function(){var a=this,b=[];return"Navigate"===this.options.MenuOptionsType?void this._build_array_of_objs_menu():("string"==typeof a.options.Data[0]?b=$.map(a.options.Data,function(a,b){return{ky:a,val:a}}):$.each(a.options.Data,function(c,d){if($.isPlainObject(a.options.Data[0])){if(a._obj_create(b,d)===!1)return!1}else $.isArray(a.options.Data)?$.isArray(a.options.Data[0])&&a._obj_create(b,d):b.push({ky:c,val:d});a.total_rec_cnt+=1}),this._runSort(b),void(this.orig_objs=this.ary_of_objs=b))},_runSort:function(a){if(this.options.Sort.length>0){var b=this.options.Sort;b[0].match(/alpha/i)&&b[1].match(/asc/i)&&a.sort(function(a,b){return a.val>b.val?1:b.val>a.val?-1:0}),b[0].match(/alpha/i)&&b[1].match(/desc/i)&&a.sort(function(a,b){return a.val<b.val?1:b.val<a.val?-1:0}),b[0].match(/num/i)&&b[1].match(/asc/i)&&a.sort(function(a,b){return a-b}),b[0].match(/num/i)&&b[1].match(/desc/i)&&a.sort(function(a,b){return b-a})}},_build_array_of_objs_menu:function(){var a=[];$.isArray(this.options.Data)?a=$.map(this.options.Data,function(a){return{ky:a[Object.keys(a)[0]],val:Object.keys(a)[0]}}):$.each(this.options.Data,function(b,c){a.push({ky:c,val:b})}),this._runSort(a),this.orig_objs=this.ary_of_objs=a},_get_custom_keys:function(a,b){var c=Object.keys(a),d=this.options.DataKeyNames.key,e=this.options.DataKeyNames.value,f=$.grep(c,function(a,b){return a===d||a===e?a:void 0});return 2!=f.length?this._validation_fail(" Data error: DataKeyNames is invalid  (it only matched "+f.length+" keys in the Data parameter)","fatal"):void b.push({ky:a[d].toString(),val:a[e].toString()})},_obj_create:function(a,b){var c;if($.isArray(b)===!0)$.each(b,function(b,c){a.push({ky:c,val:c})});else{if(Object.keys(this.options.DataKeyNames).length>0)return this._get_custom_keys(b,a);c=Object.keys(b);for(var d=0;d<c.length;d++){if(!b.hasOwnProperty(c[d]))return this._validation_fail(" Data error: Key with no value error in incoming Data parameter"),!1;a.push({ky:c[d],val:b[c[d]]})}}return!0},_set_showat:function(){this.options.ShowAt.match(/^ *bottom *$/i)?this._setOption("ShowAt","left bottom-2"):this.options.ShowAt.match(/^ *right *$/i)&&this._setOption("ShowAt","right-2 top")},_build_row:function(a,b){return $.map(b,function(b){return!$.isFunction(b.ky)&&b.ky.match(/^ *divider *$/i)&&"Navigate"===a.options.MenuOptionsType?"	<td class="+b.ky+">"+b.val+"</td>\n":'	<td class=dflt menu_opt_key="'+b.ky+'">'+b.val+"</td>\n"})},_create_table:function(a){var b="",c=[],d=[],e=0,f=0,g="",h=0,i=/bottom/.test(this.options.ShowAt)?"bot":"rt";for(this.options.UseValueForKey===!0&&a.length===this.orig_objs.length&&$.each(a,function(a,b){b.val=b.ky});e*this.options.ColumnCount<a.length;){for(f=0===e?0:e*this.options.ColumnCount,c=a.slice(f,f+this.options.ColumnCount),d=this._build_row(this,c),h=c.length+1;h<=this.options.ColumnCount;h+=1)d.push('<td class=dflt menu_opt_key="">&nbsp;</td>');b+="<tr>\n"+d.join("")+"</tr>\n",e+=1}return b="<table class=CrEaTeDtAbLeStYlE cellpadding=4px>\n"+b+"</table>",this.options.Filters.length&&0===this.cached[".mo_elem"].val().length&&(b=this._createFilterHeader()+b),$("button.navbar-toggle").length&&/block/.test($("button.navbar-toggle").css("display"))&&this.cached[".mo_elem"].closest("ul.navbar-nav").length&&(i="rt"),g="<span class="+this.options.MenuOptionsType+i+" id=SP_"+this.options._ID+">"+b+"\n</span>"},_build_filtered_dropdown:function(a,b){this._build_dropdown(b),this._show_drop_down(a)},_build_dropdown:function(a){this.options._currTD=[0,1];var b=this._create_table(a);this._event_ns=this.eventNamespace.replace(/^\./,""),this.dropdownbox=$(b),this._cache_elems(),this._calcDropBoxCoordinates()},_build_drop_down_test:function(a){return a.type===this.options._prev.event&&$(a.currentTarget).text()===this.options._prev.text?(this.__set_prev(a),!1):(this.__set_prev(a),/click/.test(a.type)&&this.cached[".mo_elem"].val(this.cached[".mo_elem"].val()),$("span#SP_"+this.options._ID).length>0&&!/keydown|keyup/.test(a.type)&&!/(all)/.test($(a.target).text())?(/input/.test(a.type)&&this._check_mask(a),!1):("search"===a.type&&this.cached[".mo_elem"].attr("menu_opt_key",""),/keydown|keyup/.test(a.type)&&this._arrow_keys(a)===!0?!1:this.options.Mask.length>0&&(/keyup|input/.test(a.type)&&this._check_mask(a,this.cached[".mo_elem"].val()),/focus/.test(a.type)&&(this._add_const(this.cached[".mo_elem"].val()),this.__set_help_msg("","good")),this.options._mask_status.mask_only===!0)?!1:/keydown/.test(a.type)&&a.keyCode===$.ui.keyCode.ENTER||a.keyCode===$.ui.keyCode.TAB?(this._tab_and_enter_keypress(a,this.cached[".mo_elem"].val()),$("span#HLP_"+this.options._ID).hide(),!1):/keydown|mousedown|click/.test(a.type)?($("span#HLP_"+this.options._ID).show(),!1):!0))},_buildWholeDropDown:function(a){if(this._build_drop_down_test(a)!==!1){var b=this.cached[".mo_elem"].val();if(b.length>0){var c=this._match_list_hilited({StrToCheck:b,chk_key:!1,case_ins:!0,evt:a});return void(c.length>0&&this._build_filtered_dropdown(a,c))}this.cached[".mo_elem"].removeClass("data_error data_good"),this._build_dropdown(this.orig_objs),this._show_drop_down(a),this.__set_help_msg("","good")}},_run_header_filter:function(a){if(a.type===this.options._prev.event&&$(a.currentTarget).text()===this.options._prev.text)return this.__set_prev(a),!1;if(this.__set_prev(a),!this.cached[".mo_elem"].val().length){var b=$(a.currentTarget).text();this.options._CurrentFilter=$(a.currentTarget).text(),$.isPlainObject(this.options.Filters[0])?$(a.currentTarget).attr("menuopt_regex")?(b=$(a.currentTarget).attr("menuopt_regex"),this._process_matches(a,b)):$(a.currentTarget).text().match(/\(all\)/i)?(this._build_dropdown(this.orig_objs),this._show_drop_down(a)):this._validation_fail("Filter key "+$(a.currentTarget).text()+"does not have a matching regular expression","warning"):$.inArray(b,this.options.Filters)>-1?this._process_matches(a,b):this._buildWholeDropDown(a),this.options._CurrentFilter=""}},_createFilterHeader:function(){var a=[],b=[];return $.isPlainObject(this.options.Filters[0])?($.each(this.options.Filters,function(c,d){b=$.map(d,function(a,b){return b}),a.push("	<td class=hf_td id=hdr_fltr"+b[0]+' menuopt_regex="'+d[b[0]]+'">'+b[0]+"</td>\n")}),a.unshift("	<td class=hf_td id=hdr_fltrAll>(all)</td>\n")):(a=$.map(this.options.Filters,function(a){return"	<td class=hf_td>"+a+"</td>\n"}),a.unshift("	<td class=hf_td>(all)</td>\n")),"\n<table id=HF_"+this._event_ns+" class=HdrFilter>\n<tr>\n"+a.join("")+"</tr>\n</table>\n"},__scroll:function(a){var b=0,c=0,d=0,e=0;0!==$(".CrEaTeDtAbLeStYlE tbody tr:nth-child("+a+")").length&&(b=$(".CrEaTeDtAbLeStYlE tbody tr:nth-child("+a+")").offset().top,c=$(".CrEaTeDtAbLeStYlE tbody tr:nth-child("+a+")").height(),d=$("span#SP_"+this.options._ID).height(),e=$("span#SP_"+this.options._ID).offset().top,e>b?(this.options._vert_ofs-=c,$("span#SP_"+this.options._ID).scrollTop(this.options._vert_ofs)):b+c>e+d&&(this.options._vert_ofs+=c,$("span#SP_"+this.options._ID).scrollTop(this.options._vert_ofs)))},_calcDropBoxCoordinates:function(){this.options._menu_box.top=this.cached[".dropdownspan"].position().top,this.options._menu_box.bottom=this.options._menu_box.top+this.cached[".dropdownspan"].height(),this.options._menu_box.left=this.cached[".dropdownspan"].position().left,this.options._menu_box.right=this.options._menu_box.left+this.cached[".dropdownspan"].width()},_didMouseExitDropDown:function(a){return a.pageX+1>this.options._menu_box.left&&a.pageX<this.options._menu_box.right-1&&a.pageY+1>this.options._menu_box.top&&a.pageY<this.options._menu_box.bottom?!1:!0},_removeDropDown:function(a){this.options._prev.event=a.type,"blur"===a.type&&/mouseleave/.test(this.options._prev.event)||($("span#SP_"+this.options._ID).length&&this._didMouseExitDropDown(a)===!0&&this.cached[".dropdownspan"].remove(),$("span#HLP_"+this.options._ID).hide())},_resetOffsetOfDropDown:function(){(this.menu_start_loc.left!==this.cached[".dropdownspan"].offset().left||this.menu_start_loc.top!==this.cached[".dropdownspan"].offset().top)&&this.cached[".dropdownspan"]&&this.cached[".dropdownspan"][0]&&(this.options._width_adj.width_adjustment=parseInt(this.cached[".dropdownspan"][0].style.left,10)+(this.options._width_adj.width_after_adj-this.options._width_adj.width_menu)/2,this.cached[".dropdownspan"].css({left:this.options._width_adj.width_adjustment}))},_addDropDownToDOM:function(){$('body span[id^="SP_menuoption"]').remove(),this.dropdownbox.appendTo("body").hide(1)},_show_drop_down:function(a){var b=this,c=0,d=this.options.ShowAt;this._addDropDownToDOM(),this._get_n_set_width(),$("button.navbar-toggle").length&&/block/.test($("button.navbar-toggle").css("display"))&&this.cached[".mo_elem"].closest("ul.navbar-nav").length&&(d="left+"+this.options.BootMenuOfs+" top"),b.cached[".dropdownspan"].stop(!0,!1).show().position({of:this.element,my:"left top",at:d,collision:"flipfit"}),c=parseInt($("span#SP_"+this.options._ID).css("width"),10),$("span#SP_"+b.options._ID).css({zIndex:9999}),this._use_scroller()&&($("span#SP_"+b.options._ID).css({"overflow-y":"scroll","overflow-x":"hidden",width:c+18,height:parseInt(b.options.Height,10)}),b.cached[".dropdownspan"].stop(!0,!1).show().position({of:this.element,my:"left top",at:d,collision:"flipfit"})),$("table.CrEaTeDtAbLeStYlE").find("tr:even").addClass("even"),
$("table.CrEaTeDtAbLeStYlE").find("tr:odd").addClass("odd"),this._refresh(),this._calcDropBoxCoordinates()},_use_scroller:function(){var a=parseInt($("span#SP_"+this.options._ID).css("height"),10);return/Select/i.test(this.options.MenuOptionsType)&&/^\d+/.test(this.options.Height)&&parseInt(this.options.Height,10)<a},_get_n_set_width:function(){var a=this,b=parseInt($("span#SP_"+this.options._ID).css("width"),10);a.menu_start_loc=a.cached[".dropdownspan"].offset(),a.options._width_adj.width_menu=b,a.options._width_adj.width_after_adj=b>this.cached[".mo_elem"].width()?b:this.cached[".mo_elem"].outerWidth(),""!==a.options.Width&&0!==a.options.Width&&(a.options._width_adj.width_after_adj=parseInt(a.options.Width,10)),$("span#SP_"+a.options._ID+", span#SP_"+a.options._ID+" > table").css({width:a.options._width_adj.width_after_adj}),this.options.ShowAt.match(/left[\w\W]*bottom[\w\W]*/i)?$("span#SP_"+a.options._ID).offset({left:this.cached[".mo_elem"].offset().left}):$("span#SP_"+a.options._ID).offset({left:this.cached[".mo_elem"].offset().left+this.cached[".mo_elem"].outerWidth()})},_day_test:function(a,b,c,d){return/\d/.test(a[d])&&a[d]<=b?!0:("cut"===c&&this._cut_last_char(a,"0 - "+b+" only"),!1)},_parse_days:function(a,b,c){return a.length===b?this._day_test(a,c[0],"cut",a.length-1):a.length===b+1?a[b-1]===c[0]?this._day_test(a,c[1],"cut",a.length-1):this._day_test(a,9,"cut",a.length-1):a.length===this.options._mask.MaxLen?a.substring(b-1,b+1)<=c:void 0},_get_days:function(a,b){var c,d=!0,e=-1,f=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");switch(b){case"YMD":if(e=parseInt(a.substring(4,6),10),c=new Date(a.substring(0,4),e,0).getDate().toString(),7===a.length)return this._day_test(a,c[0],"cut",6);if(8===a.length)return 2===e&&a.substring(6,8)>c?(this._cut_last_char(a,"not a leap year"),!1):this._parse_days(a,7,c);break;case"MdY":if(e=f.indexOf(a.substring(0,3))+1,0===e)return this.cached[".mo_elem"].val(""),!1;if(c=/^2$/.test(e)?"29":/^(1|3|5|7|8|10|12)$/.test(e)?"31":"30",2!==e||12!==a.length)return this._parse_days(a,5,c);if(a.substring(4,6)>new Date(a.substring(8,12),e,0).getDate())return this.__set_help_msg("not a leap year","error"),!1}return d},_is_char_valid:function(a,b,c,d,e){var f="string"===d?"^("+b+")$":"["+b+"]",g="string"===d?a:a[e];return new RegExp(f).test(g)?!0:(this._cut_last_char(a,c),!1)},_date_hotkeys:function(a){var b=a.val.substring(a.ofs-1,a.ofs),c=!1;switch(!0){case/^t$/.test(a.val):c=this.__todays_date(a.fmt);break;case/H:M/.test(a.fmt)&&/^n$/i.test(a.val):c=this.__time_now();break;case/MdY/.test(a.fmt):1===a.val.length?c=this.__mon_first_ltr(b):2===a.val.length&&(c=this.__mon_sec_ltr(a.val))}return c},__time_now:function(a){var b=new Date,c=b.getHours(),d=b.getMinutes(),e=c>12?" PM":" AM";return d=10>d?"0"+d:d,c=(c+11)%12+1,c=10>c?"0"+c:c,$(this.element).val(c+":"+d+e),this.__match_complete(),!0},__todays_date:function(a){var b=!1,c=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),d=new Date,e=("0"+d.getDate()).slice(-2),f=("0"+(d.getMonth()+1)).slice(-2),g=d.getFullYear();switch(a){case"YMD":$(this.element).val(g+""+f+e),b=!0;break;case"MdY":$(this.element).val(c[d.getMonth()]+" "+e+", "+g),b=!0}return b},__mon_sec_ltr:function(a){var b={Ja:"Jan",Ap:"Apr",Au:"Aug"};return/^(Au|Ap|Ja)$/i.test(a)?($(this.element).val(b[a]+" "),!0):!1},__mon_first_ltr:function(a){var b=!1;if(/[FOSND]/i.test(a)){var c={F:"Feb",S:"Sep",O:"Oct",N:"Nov",D:"Dec"};$(this.element).val(c[a.toUpperCase()]+" "),b=!0}else/[JAM]/i.test(a)&&($(this.element).val(a.toUpperCase()),b=!0);return b}});